# 哈希表



### 0x00 基本定义



**Definition** 数组可以被称为==直接寻址表==（direct-address table）， 因为我们需要访问数组中的某个元素的时候，直接使用其对应的数组下标即可.  即具有关键字为$k$的元素放在数组的$k$槽里面. 



**Definition** 若关键字$k$的元素放在数组的$h(k)$糟中，其中$h(x)$表示一个hash function，此时的数组我们称为==哈希表==.  称$h(k)$为关键字$k$的hash value. 



### 0x01 解决冲突

由于$h(x)$可能不是具有单值性，因此存在$h(k_1) = h(k_2)$，那么其hashtable上$h(k_1)$对应的凹槽处就需要存放两个元素，为了解决这个冲突，存在两种方法

1. ==链接法== 每个凹槽处我们用一种链表来表示，即可以记录多个hash-value相同的关键字。 
2. ==开放寻址法== 将所有元素都放在哈希表里面，当出现冲突的时候，我们使用的一种系统的方法去二次查询。



**Definition** 对于一个能存放$n$个元素，具有$m$个槽位的hashtable $T$，定义$T$的==装载因子==$\alpha$为$\frac{m}{n}$.  

**Definition** 假定任意给定一个元素都会等可能的落到$m$个槽中的任意一个，且与其他元素被散列到什么位置上无关，称这个假设为==简单均匀散列==（simple uniform hashing）. 



**Lemma** 在简单均匀散列的假设下，给定$n$个元素，落在第$j$个凹槽上的期望为$E(k=j) = \frac{m}{n}$.



**Proposition** 在简单均匀散列的假设下，对应用链表法解决冲突的hashtable，一次不成功查找的平均时间为$O(1+\alpha)$. 

*proof*. 其中$O(1)$表示计算一次hash-value所需要的时间，而$O(\alpha)$表示对某条单链表遍历完成所需要时间，因为是在不成功查找的前提下. 



**Proposition** 在简单均匀散列的假设下，对应用链表法解决冲突的hashtable，一次成功查找的平均时间为$O(1+\alpha)$. 

*proof*.  分析这个问题的关键在于，需要准确的刻画你需要查找的那个元素$x$在链表的哪个位置？ 即需要算出$x$前面元素个数期望.





### 0x02 散列函数

对于一个散列函数的思考:

1. ==一个好的散列函数应该近似满足简单均匀假设==. 
2. 一个散列函数应该具备接受的输入不仅仅是数字，当接受一个字符串时应能将其转换为数字. 



常见的散列函数的设计

1. 除法散列 $h(k) = k~ \text{mod} ~m$，其中$m$表示散列表的长度.  一个不接近$2$的整数幂的素数的素数通常是一个好的除数$m$选择. 

2. 乘法散列 $h(k) = \lfloor m(kA ~\text{mod}~ 1) \rfloor$，其中$0 < A < 1$.  一般的取$m$为某个$2^k$.  

   若某计算机的字长为$\omega$，我们取$A = \frac{s}{2^\omega}$，其中$0< s < 2^\omega$且$s$是一个自然数.  那么$Ak \cdot 2^\omega$就是一个2个字长的自然数，可以用$r_12^\omega+r_0$表示，其中$r_1$表示它的前面这个乘积的高位字，而$r_0$表示乘积的低位字.  设$m=2^p$也是一个字长的自然数，显然$r_0$的高$p$位就是所求的hashvalue.  这是为什么呢？ 

   显然$A$是可以用一个字长来表示的，即$A = i_12^{-1} + i_22^{-2} + \cdots + i_\omega2^{-\omega}$，其中$i_1,i_2,\cdots,i_\omega \in \{0,1\}$.  对于$k$我们也用$k = j_12^{1} + j_22^{2} + \cdots + j_\omega2^{\omega}$表示，因此
   $$
   Ak\cdot 2^{\omega} = (i_12^{-1} + i_22^{-2} + \cdots + i_\omega2^{-\omega})(j_12^{1} + j_22^{2} + \cdots + j_\omega2^{\omega})2^{\omega}
   $$
   实际上就是把$Ak$的小数搬到了$r_0$上，再乘上$m=2^p$再取整，就是取了$r_0$的高$p$的那串数字. 

3. 全域散列























