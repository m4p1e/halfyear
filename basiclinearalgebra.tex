\documentclass{article}

\usepackage{ctex}
\usepackage{tikz}
\usetikzlibrary{cd}
%\usetikzlibrary{paths.ortho} % path折线
%\usetikzlibrary{decorations.pathreplacing}
\usetikzlibrary{calc}
\usetikzlibrary{graphs, graphs.standard, quotes}% quotes library is for the [""] edges
\usetikzlibrary{positioning} %right of 描述位置的


\usepackage{arydshln}
%\usepackage{mathtools}

\usepackage{amsthm}
\usepackage{amsmath}
\usepackage{amssymb}
\usepackage{blkarray} %更丰富的array

\usepackage{hyperref} %url
\hypersetup{
    colorlinks=true,
    linkcolor=blue,
    filecolor=magenta,      
    urlcolor=cyan,
    pdftitle={Overleaf Example},
    pdfpagemode=FullScreen,
    }


\usepackage{enumitem}

\usepackage[textwidth=18cm]{geometry} % 设置页宽=18

\usepackage{blindtext}
\usepackage{bm}
\parindent=0pt
\setlength{\parindent}{2em} 
\usepackage{indentfirst}


\usepackage{pifont} %圆圈数字
\usepackage{xcolor}
\usepackage{titlesec}
\titleformat{\section}[block]{\color{blue}\Large\bfseries\filcenter}{}{1em}{}
\titleformat{\subsection}[hang]{\color{red}\Large\bfseries}{}{0em}{}
%\setcounter{secnumdepth}{1} %section 序号

\counterwithin*{equation}{section} %equation重新编号
\counterwithin*{equation}{subsection}

\newtheorem{theorem}{Theorem}[section]
\newtheorem{lemma}[theorem]{Lemma}
\newtheorem{corollary}[theorem]{Corollary}
\newtheorem{proposition}[theorem]{Proposition}
\newtheorem{example}[theorem]{Example}
\newtheorem{definition}[theorem]{Definition}
\newtheorem{remark}[theorem]{Remark}
\newtheorem{exercise}{Exercise}[section]
\newtheorem{annotation}[theorem]{Annotation}

\newcommand*{\xfunc}[4]{{#2}\colon{#3}{#1}{#4}}
\newcommand*{\func}[3]{\xfunc{\to}{#1}{#2}{#3}}

\newcommand\Set[2]{\{\,#1\mid#2\,\}} %集合
\newcommand\SET[2]{\Set{#1}{\text{#2}}} %

\newcommand{\norm}[1]{\left\lVert#1\right\rVert} % 范数
\newcommand{\vect}[1]{\mathbf{#1}} % vector

\newcommand\bigzero{\makebox(0,0){\text{\huge0}}} %bigzero
\newcommand{\hints}{{\color{blue} \text{hints}}}
\newcommand{\mbf}[1]{\bm{#1}} 
\newcommand{\rank}[1]{\text{rank}(#1)} % rank
\newcommand\inp[2]{\langle #1, #2 \rangle} %inner product
\begin{document}
\title{考研线代}
\author{枫聆}
\maketitle
\tableofcontents

\newpage 
\section{高等代数的研究对象}

linear algebra在研究多元一次方程组的解的过程中逐渐形成的一门学科. 如有这样一个方程组
$$
\begin{array}{cl}
x_1 + 3x_2 + x_3 &= 2,\\
3x_1 + 4x_2 + 2x_3 &= 9, \\
-x_1 - 5x_2 + 4x_3 &= 10,  \\
2x_2 + 7x_2 + x_3 &= 1
\end{array}
$$
我们求解方程组的解过程通常是把用某一行的$n$倍加上或者减去另一行，这种情况下我们其实是在对每一行方程的变元前面的系数做运算，只要我们排列好对应系数的位置就可以避免每一次都写变元，自然而然地，多元一次方程组对应的{\color{red}系数矩阵}和 {\color{red} 增广矩阵}就诞生了，例如上面方程组的增广矩阵如下
$$
\begin{bmatrix}
1 & 3 & 1 & 2 \\
3 & 4 & 2 & 9 \\
-1 & -5 & 4 & 10  \\
2 & 7 & 1 & 1
\end{bmatrix}
$$
这个矩阵也可以称为4阶矩阵($4 \times 4$). 去掉最后常数项列就是对应的系数矩阵. 我们通过研究增广矩阵来研究原方程的解，那么研究方程组的解可以从两个方向出发，把解直接解出来或者判别方程组解的情况.

%两种折线
\tikzset{
  -|-/.style={
    to path={
      (\tikztostart) -| ($(\tikztostart)!#1!(\tikztotarget)$) |- (\tikztotarget)
      \tikztonodes
    }
  },
  -|-/.default=0.5,
  |-|/.style={
    to path={
      (\tikztostart) |- ($(\tikztostart)!#1!(\tikztotarget)$) -| (\tikztotarget)
      \tikztonodes
    }
  },
  |-|/.default=0.5,
}

\begin{center}
\begin{tikzpicture}[v/.style={rectangle,draw=blue}]
\node (linear equation) [v] {n元线性方程组};
\node (matrix) [v, below right = of linear equation] {矩阵};
%\node (vector) [v, below = of linear equation] {n维向量};
\node (vector space) [v, below = of linear equation] {n维向量空间};
\node (linear space) [v, below = of vector space] {线性空间};
\node (linear map)	[v, below = of matrix] {线性映射};
\node (linear transform) [v, below = of linear map] {线性变换};
\node (double vector-value function) [v, left = of linear space] {双线性函数};
\node (linear metric space) [v, below = of double vector-value function] {具有度量的线性空间};
\node (metric via linear transformation) [v,below = of $(linear metric space)!0.5!(linear transform)$] {与度量相关的线性变换};
\coordinate (metric join linear transformation) at ([yshift=0.5cm]metric via linear transformation.north); 

\draw [->]	(linear equation) to (vector space);
\draw [->]	(linear equation.east) -| (matrix);
\draw [->]	(vector space) to (linear space);
\draw [->]	(linear space) to (linear map);
\draw [->]	(linear map) to (linear transform);
\draw [->]	(linear space) to (double vector-value function);
\draw [<->]	(matrix) to (linear map);
\draw [->]	(double vector-value function) to (linear metric space);
\draw [-] (linear transform) |- (metric join linear transformation);
\draw [-] (linear metric space) |- (metric join linear transformation);
\draw [->] (metric join linear transformation) -> (metric via linear transformation.north);
\end{tikzpicture}
\end{center}
上图是整个linear algebra研究过程的发展，值得关注是{\color{red}线性空间是向量空间的一般推广}；{\color{red} 矩阵不光可以表示$n$维线性方程，同样也是可以用来表示线性映射}； {\color{red}线性空间到自身的线性映射叫做线性变换}； {\color{red} 从线性空间到线性度量空间需要用到一个双线性函数来描述两个其空间两个元素的度量}；


\begin{definition}
\rm {\color{red} 阶梯型矩阵} 若给定矩阵满足下面条件
\begin{enumerate}
	\item $0$行全在下方;
	\item {\color{red}主元}(非零行第一个非零元素)的列指标随着行指标的增加而严格增大.
\end{enumerate}
则称其为行阶梯形矩阵. i.e.
$$
\begin{pmatrix}
{\color{red}1} & 3 & 1 & 2 \\
0 & {\color{red}1} & -1 & -3 \\
0 & 0 & {\color{red}3} & 6 \\
0 & 0 & 0 & 0 \\
\end{pmatrix}
$$
同理还有列阶梯形矩阵，把上面这个矩阵顺时针旋转90°.
$$
\begin{pmatrix}
2 & -3 & 6 & 0 \\
1 & -1 & 3 & 0 \\
3 & 3 & 0 & 0  \\
1 & 0 & 0 & 0 \\
\end{pmatrix}
$$
\end{definition}

\begin{definition}
\rm {\color{red} (简化阶梯型矩阵)} 若给定行阶梯形满足下面条件
\begin{enumerate}
	\item 主元都是$1$.
	\item 主元所在列的其余元素都是$0$.
\end{enumerate}
则称其为简化行阶梯形矩阵. i.e.
$$
\begin{pmatrix}
{\color{red}1} & 0 & 0 & 3 \\
0 & {\color{red}1} & 0 & -1 \\
0 & 0 & {\color{red}1} & 2 \\
0 & 0 & 0 & 0 \\
\end{pmatrix}
$$
\end{definition}

\begin{definition}
\rm 下面几种矩阵变换操作称之为矩阵的{\color{red}初等行变换}
\begin{enumerate}
	\item 把一行的倍数加到另一行上;
	\item 两行互换;
	\item 一行乘以一个非零数.
\end{enumerate}
\end{definition}

\begin{theorem}
\rm {\color{red} (初等行变换的性质)}矩阵的初等行变换得到的方程组与原来的方程组同解.
\end{theorem}

\begin{proposition}
\rm {\color{red} (线性方程组的判别方法)} $n$元线性方程组解的情况只有三种可能，其对应的行阶梯行矩阵的特征如下
\begin{enumerate}
	\item 若非零行个数等于未知数个数，则有唯一解;
	\item 若非零行个数小于未知数个数，则有无穷多个解;
	\item 若存在非零行对应等式$0=d$，其中$d$不等于零，则无解.
\end{enumerate}
有一个很形象的理解方式类比{\color{blue}到平面上两条直线，它们可能存在三种关系: 平行，相交(相交于一点)，重合}.
\end{proposition}

\begin{proof}
其中无解对应的情况是显然的，那么我们在确保不会出现$0=d$的情况下有解，且为什么只会出现唯一解或者无穷多个解，而不会出现有两个解的这种情况呢？ 若给定$n$元线性方程组的增广矩阵，经过初等行变换化成行阶梯形矩阵$J$. 设$J$有$r$个非零行，$J$有$n+1$列，其中$n+1$列表示等式右边的常数项.
$$
J=
\begin{pmatrix}
\cdots & \cdots &c_1 \\
\vdots & \vdots & \vdots \\
\cdots & b_{rt} &\cdots \\
&\bigzero&
\end{pmatrix}
$$
设$r$行的主元为$b_{rt}$，即它在第$t$列，那么必有$t \leq n$. 根据行阶梯形的定义，列指标是随着行指标的增加而严格增大的，因此也有$t \geq r$，同时$t \leq n$，因此可以得到$r \leq n$，即非零行的个数是不会超过$n$的. 此刻再把$J$通过初等行变换变成简化行阶梯形矩阵$J_1$，那么$J_1$也有$r$非零行，即有$r$个主元，下面分两种情况分别讨论: {\color{red}当$r=n$时}，$J_1$就有$n$个主元，那么按照行阶梯形主元排列顺序，
$$
J_1 =
\begin{pmatrix}
1 & \cdots & \cdots &\cdots & c_1 \\
0 & 1 & \cdots & \cdots & c_2 \\
0 & 0 & 1 & \cdots & c_3 \\
\vdots & \vdots & \vdots & \vdots & \vdots \\
\cdots & \cdots & \cdots & 1 & c_n 
\end{pmatrix}
$$
即$n$个主元，要分别放到$n$列，那么就是每列都有一个主元，即原方程组有唯一解. {\color{red}当$r < n$时}，此时简化行梯形矩阵为
$$
J_1 =
\begin{pmatrix}
1 & \cdots & \cdots &\cdots & \cdots & c_1 \\
\cdots & 1 & \cdots & \cdots & \cdots & c_2 \\
\cdots & \cdots & 1 & \cdots & \cdots & c_3 \\
\vdots & \vdots & \vdots & \vdots & \vdots & \vdots \\
\cdots & \cdots & \cdots & 1 & \cdots & c_r 
\end{pmatrix}
$$
那么现在我们可以把上面这$r$个主元对应的未知数表示出来
$$
\begin{array}{ll}
x_1 &= b_{1,1}x_{i_1} + b_{1,2}x_{i_2} + \cdots + b_{1,n-r} x_{n-r} + d_1 \\
x_{j_2} &= b_{j_2,1}x_{i_1} + b_{j_2,2}x_{i_2} + \cdots + b_{j-2,n-r} x_{n-r} + d_{j_2} \\
&\vdots \\
x_{j_r} &= b_{j_r,1}x_{i_1} + b_{j_r,2}x_{i_2} + \cdots + b_{j-r,n-r} x_{n-r} + d_{j_r}
\end{array}
$$
其中$x_1,x_{j_2},\cdots x_{j_r}$表示对应列的$r$个主元，其余的自由变量有$n-r$个用$x_{i_1},x_{i_2},\cdots,x_{n-r}$表示，常数$b_{ij}$. 那么只要任意确定一组自由变量的取值，也就确定了一组解，即这种情况下只有无穷多个解，上面这个形式也称为{\color{red}一般解}.
\end{proof}

\begin{definition}
\rm $n$元齐次线性方程组如下
$$
\begin{array}{l}
a_{11}x_1 + a_{12}x_2 + \cdots a_{1n}x_n = 0 \\
a_{21}x_1 + a_{22}x_2 + \cdots a_{2n}x_n = 0 \\
\vdots \\
a_{m1}x_1 + a_{m2}x_2 + \cdots a_{mn}x_n = 0 \\
\end{array}
$$
显然$(0,0,\cdots,0)$是它的一个解，称为{\color{red}零解}; 其余的解(如果有)称为{\color{red}非零解}.
\end{definition}

\begin{lemma}
\rm {\color{red} (齐次线性方程组有非零解的充要条件)} $n$元齐次线性方程组有非零解当且仅当{\color{red}系数矩阵}经过初等行变换得到的阶梯形矩阵的非零行个数$r<n$.
\end{lemma}

\begin{lemma}
\rm {\color{red} (齐次线性方程族有非零解的充分条件)} $n$元齐次线性方程组的方程个数$m < n$，则它有非零解.
\end{lemma}


\newpage
\section{行列式}
\subsection{行列式的基本定义}
%Determinant
\begin{annotation}
\rm {\color{red} 行列式的意义} 在用矩阵解$n$元线性方程组的过程中，我们需要将对应的增广矩阵转换为阶梯型矩阵，然后向上回溯求解. 如果对于一个$n$元线性方程组，我们只想关注它的解结构或者更明确一点，是否有解就够了，那我们是否可以在不把具体解解出来的情况下，回答这个问题呢？也就是说我们是否在可以在不进行初等行变换化阶梯形矩阵的情况下，来回答这个问题？

从二元线性方程组作为例子出发来进行讨论，给定一个二元线性方程组
$$
\begin{array}{ll}
a_{11}x_1 + a_{12}x_2 = c_1 \\
a_{21}x_1 + a_{22}x_2 = c_2
\end{array}
$$
其中$a_{11},a_{21}$不全为$0$，不妨设$a_{11}$不等于$0$. 其对应的增广矩阵通过初等行变换化作阶梯形矩阵如下
$$
\begin{pmatrix}
a_{11} & a_{12} & c_1 \\
0 & a_{22}-a_{12}\frac{a_{21}}{a_{11}} & c_2 -c_1\frac{a_{21}}{a_{11}} \\
\end{pmatrix}
=
\begin{pmatrix}
a_{11} & a_{12} & c_1 \\ 
0 & \frac{a_{11}a_{22}-a_{12}a_{21}}{a_{11}} & \frac{c_2a_{11}-c_1a_{21}}{a_{11}} \\
\end{pmatrix}
$$
若$a_{11}a_{22}-a_{12}a_{21} \neq 0$，则原方程组有唯一解; 反之，若$a_{11}a_{22}-a_{12}a_{21} = 0$，则原方程组有无穷多个解或者无解. 可以很快发现$a_{11}a_{22}-a_{12}a_{21}$就是$\begin{pmatrix}
a_{11} & a_{12} \\
a_{21} & a_{21} 
\end{pmatrix}$的行列式，称其为{\color{red} 二阶行列式}. 基于这个直觉就将其推广到$n$元方程组对应的系数矩阵行列式来判别解的情况. 观察$x_2 = \frac{c_2a_{11}-c_1a_{21}}{a_{11}a_{22}-a_{12}a_{21}}$，实际上它就是两个行列式做除法
$$
x_2 = \frac{\begin{pmatrix}
a_{11} & c_1\\
a_{21} & c_2 
\end{pmatrix}}{\begin{pmatrix}
a_{11} & a_{12} \\
a_{21} & a_{21} 
\end{pmatrix}}
=\frac{|\mbf{B}_2|}{|\mbf{A}|}.
$$
其中$|\mbf{B}_1|$就是将其系数矩阵的第2列换成常数项，这也是后面会提到{\color{red}克拉默法则}的一个特殊情况.
\end{annotation}

\begin{definition}
\rm {\color{red} (逆序数的概率)} 若给定一个排列$j_1j_2\cdots j_n$，取其中任意两个不同的数$j_p$和$j_q$，使得$1 \leq p< q <n$. 若$j_p > j_q$，就称$j_p$和$j_q$构成一个{\color{red}逆序}. 一个排列中所有逆序的总和称为这个排列的{\color{red}逆序数}. 特别地，如果一个排列的逆序数是偶数，则称这个排列为{\color{red}偶排列}，否则称为{\color{red}奇排列}.
\end{definition}

\begin{definition}
\rm {\color{red} ($n$阶行列式的概念)} $n$阶行列式的{\color{red}完全展开式}如下
$$
\begin{vmatrix}
a_{11} & a_{12} & \cdots & a_{1n} \\
a_{21} & a_{22} & \cdots & a_{2n} \\
\vdots & \vdots & 		 & \vdots \\
a_{n1} & a_{n2} & \cdots & a_{nn} \\
\end{vmatrix}
=\sum\limits_{j_1,j_2,\cdots,j_n} (-1)^{\tau(j_1j_2\cdots j_n)} a_{1j_1}a_{2j_2}\cdots a_{nj_n}.
$$
其中$j_1,j_2,\cdots,j_n$表示一组列指标的排列，即$a_{1j_1}a_{2j_2}\cdots a_{nj_n}$表示取自不同行不同列的$n$个元素的乘积. 用$\tau(j_1j_2\cdots j_n)$表示$j_1j_2\cdots j_n$的逆序数.  
\end{definition}

\begin{definition}
\rm 记$|\mathbf{A}| = \begin{vmatrix}
a_{11} & a_{12} & \cdots & a_{1n} \\
a_{21} & a_{22} & \cdots & a_{2n} \\
\vdots & \vdots & 		 & \vdots \\
a_{n1} & a_{n2} & \cdots & a_{nn} \\
\end{vmatrix}$，$|\mathbf{A}^T| = \begin{vmatrix}
a_{11} & a_{21} & \cdots & a_{n1} \\
a_{12} & a_{22} & \cdots & a_{n2} \\
\vdots & \vdots & 		 & \vdots \\
a_{1n} & a_{n2} & \cdots & a_{nn} \\
\end{vmatrix}$称为$|\mbf{A}|$的{\color{red}转置行列式}.
\end{definition}

\newpage
\subsection{行列式的基本性质}
\begin{lemma}\label{det: nixu}
\rm 一个排列中任意两个元素对换，其逆序数的奇偶性改变.
\end{lemma}

\begin{proof}
设给定一个排列为$j_1j_2\cdots j_n$，先考虑两个相邻的数交换，即
$$
j_1j_2\cdots j_{i}j_{i+1}\cdots j_n \longrightarrow j_1j_2\cdots j_{i+1}j_{i}\cdots j_n
$$
其中$1\leq i <n$. 很显然相邻的两个数交换，并不会影响它们两边的数的逆序个数，再分两种情况讨论，若$j_i > j_k$，那么变换之后的排列的逆序数减1; 若$j_i < j_k$，那么变换之后的排列数的逆序数加1即，因此做一次相邻交换其奇偶性改变. 再来考虑交换任意两个数$j_i$和$j_k$，我们可以把这个交换拆解为多个相邻数的交换，即
$$
j_1j_2\cdots j_{i}\cdots j_{k}\cdots j_n \longrightarrow j_1j_2\cdots j_{i-1}\cdots j_{i}j_{k}\cdots j_n \longrightarrow j_1j_2\cdots j_{i-1}j_k\cdots j_{i}\cdots j_n
$$
那么第一个箭头做了$k-i-1$次两两交换，第二个箭头做了$k-i$次两两交换，那么一共做了$2(k-i)-1$次，因此这个排列的逆序数的奇偶性一定会改变.
\end{proof}

\begin{lemma}\label{det: nixu2}
\rm 任意一个排列$j_1j_2\cdots j_n$的逆序数与它经过一系列对换变到自然序$123\cdots n$的次数的奇偶性相同.
\end{lemma}

\begin{proof}
首先自然序的逆序数等于0是一个偶数，那么分两种情况来考虑. 若$j_1j_2\cdots j_n$逆序数是一个奇数，那么它必须经过奇数次相邻变换才能得到一个逆序数是偶数的排列，同理若$j_1j_2\cdots j_n$逆序数是一个偶数，那么它必须经过偶数次相邻变换才能得到一个逆序数是偶数的排列.
\end{proof}


\begin{lemma}\label{det: nixu3}
\rm 任取$n$阶行列式中一项$(-1)^{\tau(j_1j_2\cdots j_n)}a_{1j_1}a_{2j_2}\cdots a_{nj_n}$经过$s$次两个元素位置互换，使其变成了$a_{i_1k_1}a_{i_2k_2}\cdots a_{i_nk_n}$，则
$$
(-1)^{\tau(j_1j_2\cdots j_n)} = (-1)^{\tau(i_1i_2\cdots i_n)+\tau(k_1k_2\cdots k_n)}.
$$
{\color{blue} 元素位置交换得到新排列的行指标逆序数与列指标逆序数的和与原来排列逆序数的奇偶性相同}. {\color{red} 这个lemma还是比较重要的，因为它可以改写行列式通项公式的，就是说不一定行指标要按自然序排列}，即选定行指标$i_1,i_2,\cdots,i_n$之后，有
$$
\sum\limits_{k_1,k_2,\cdots,k_n}(-1)^{\tau(i_1i_2\cdots i_n) + \tau(k_1k_2\cdots k_n)}a_{i_1k_1}a_{i_2k_2}\cdots a_{nj_n}.
$$
\end{lemma}

\begin{proof}
分别考虑行指标和列指标的变换，则有
$$
\begin{array}{ll}
(-1)^{\tau(i_1i_2\cdots i_n)} = (-1)^s (-1)^{\tau(123\cdots n)} \\
(-1)^{\tau(k_1k_2\cdots k_n)} = (-1)^s (-1)^{\tau(j_1j_2\cdots j_n)}
\end{array}
$$
两式左右两边相乘就可以得到命题结果.
\end{proof}

\begin{proposition}
\rm 行列式的基本性质如下
\begin{enumerate}
	\item 行列式和它的转置行列式相等，即$|\mathbf{A}^T| = |\mathbf{A}|$;
	\item 两行互换位置，行列式的值变号;
	\item 某行若有公因子$k$，则可以把$k$提出行列式记号之外;
	\item 如果行列式某行(或列)是两个元素之和，则可把行列式拆成两个行列式之和;
	$$
	\begin{vmatrix}
a_{11} & a_{12} & \cdots & a_{1n} \\
\vdots & \vdots & 		& \\
a_{i1}+b_{i1} & a_{i2}+b_{i1} & \cdots & a_{in}+b_{in} \\
\vdots & \vdots & 		 & \vdots \\
a_{n1} & a_{n2} & \cdots & a_{nn} \\
\end{vmatrix}
	 = \begin{vmatrix}
a_{11} & a_{12} & \cdots & a_{1n} \\
\vdots & \vdots & 		& \\
a_{i1} & a_{i2} & \cdots & a_{in} \\
\vdots & \vdots & 		 & \vdots \\
a_{n1} & a_{n2} & \cdots & a_{nn} \\
\end{vmatrix} +
	 \begin{vmatrix}
a_{11} & a_{12} & \cdots & a_{1n} \\
\vdots & \vdots & 		& \\
b_{i1} & b_{i1} & \cdots & b_{in} \\
\vdots & \vdots & 		 & \vdots \\
a_{n1} & a_{n2} & \cdots & a_{nn} \\
\end{vmatrix}
	$$
	\item 把某行(或者列)的$k$加到另一行(或者列)，行列式的值不变({\color{red} 契合初等变换中最重要的一个性质}).
\end{enumerate}
\end{proposition}

\begin{proof}
给定$n$阶行列式为$\begin{vmatrix}
a_{11} & a_{12} & \cdots & a_{1n} \\
a_{21} & a_{22} & \cdots & a_{2n} \\
\vdots & \vdots & 		 & \vdots \\
a_{n1} & a_{n2} & \cdots & a_{nn} \\
\end{vmatrix}$.

{\color{red}(1)} 设$|\mathbf{A}^T|=\sum\limits_{p_1,p_2,\cdots,p_n} (-1)^{\tau(p_1p_2\cdots p_n)} b_{1p_1}b_{2p_2}\cdots b_{np_n} = \sum\limits_{p_1,p_2,\cdots,p_n} (-1)^{\tau(p_1p_2\cdots p_n)} a_{p_11}a_{p_22}\cdots a_{p_nn}$，其中$b_{ij} = a_{ji}$. 要证明$|\mathbf{A}| = |\mathbf{A}^T|$，{\color{blue}我们需要证明对于$|A^T|$代数和中的任意一项都有$|\mathbf{A}|$代数和的一项与其对应，反之亦然}. 那么任取$|\mathbf{A}^T|$中一项$\sum\limits (-1)^{\tau(p_1p_2\cdots p_n)} a_{p_11}a_{p_22}\cdots a_{p_nn}$，我们可以让其通过有限次相邻元素交换变成$a_{1q_1}a_{2q_2}\cdots a_{nq_n}$之后，现在这个排列就是按行取元素的一个形式，但是还不确定是其逆序数的情况，记其相邻交换的次数为$s$. 这里我们同时考察行指标和列指标变化，即有
$$
\begin{array}{ll}
(-1)^{\tau(q_1q_2\cdots q_n)} = (-1)^{s} (-1)^{\tau(123\cdots n)} \\
(-1)^{\tau(123\cdots n)} = (-1)^{s} (-1)^{\tau(p_1p_2\cdots p_n)}.
\end{array}
$$ 
等式两边相差我们就可以得到$(-1)^{\tau(q_1q_2\cdots q_n)} = (-1)^{\tau(p_1p_2\cdots p_3)}$，所以经过变换之后确实找到了$|\mathbf{A}|$代数和中的一项，实际上这是lemma \ref{det: nixu3} 中的一个特殊情况. 反之任取$|\mathbf{A}|$代数和中的一项$\sum\limits_{p_1,p_2,\cdots,p_n}(-1)^{\tau(p_1p_2\cdots p_n)}a_{1p_1}a_{2p_2}\cdots a_{np_n}$，也可以在$|A^T|$代数和中找到一项$\sum\limits_{q_1,q_2,\cdots,q_n}(-1)^{\tau(q_1q_2\cdots q_n)}a_{q_11}a_{q_22}\cdots a_{q_nn}$与之对应. {\color{blue}这个性质更本质的意义是行列式中的行和列具有同等的地位}.


{\color{red}(2)} 如果我们交换第$i$和$k$行得到的矩阵我们记为$A_2$，如下
$$
\begin{vmatrix}
a_{11} & a_{12} & \cdots & a_{1n} \\
\vdots & \vdots & 		 & \vdots \\
a_{i1} & a_{i2} & \cdots & a_{in} \\
\vdots & \vdots & 		 & \vdots \\
a_{k1} & a_{k2} & \cdots & a_{kn} \\
\vdots & \vdots & 		 & \vdots \\
a_{n1} & a_{n2} & \cdots & a_{nn} \\
\end{vmatrix} \longrightarrow
\begin{vmatrix}
a_{11} & a_{12} & \cdots & a_{1n} \\
\vdots & \vdots & 		 & \vdots \\
a_{k1} & a_{k2} & \cdots & a_{kn} \\
\vdots & \vdots & 		 & \vdots \\
a_{i1} & a_{i2} & \cdots & a_{in} \\
\vdots & \vdots & 		 & \vdots \\
a_{n1} & a_{n2} & \cdots & a_{nn} \\
\end{vmatrix} 
$$
那么
$$
\begin{array}{ll}
\det(\mathbf{A}_2) &=  \sum\limits_{j_1,j_2,\cdots,j_n} (-1)^{\tau(j_1j_2\cdots j_n)} b_{1j_1}b_{1j_1}b_{2j_1}\cdots b_{nj_n}\\
&= \sum\limits_{j_1,j_2,\cdots,j_n} (-1)^{\tau(j_1j_2\cdots {\color{red}j_i} \cdots {\color{red}j_k}\cdots j_n)} a_{1j_1}a_{2j_2}\cdots a_{kj_{k}}\cdots a_{ij_{i}} \cdots a_{nj_n} \\
&= \sum\limits_{j_1,j_2,\cdots,j_n} (-1)^{\tau(j_1j_2\cdots {\color{red}j_k} \cdots {\color{red}j_i}\cdots j_n)+1} a_{1j_1}a_{2j_2}\cdots a_{ij_{i}}\cdots a_{kj_{k}} \cdots a_{nj_n}\; ({\color{blue}\text{性质1}})\\
&= (-1)\sum\limits_{j_1,j_2,\cdots,j_n} (-1)^{\tau(j_1j_2\cdots {\color{red}j_k} \cdots {\color{red}j_i}\cdots j_n)} a_{1j_1}a_{2j_2}\cdots a_{ij_{i}}\cdots a_{kj_{k}} \cdots a_{nj_n}
\end{array}
$$
这里有一个推论是{\color{red}若行列式有两行(或者列)完全相同，那么此行列式等于零}. 这是因为$|\mathbf{A}|=-|\mathbf{A}|$，所以$|\mathbf{A}|=0$.

{\color{red}(3)} 考虑下面行列式
$$
|\mathbf{B}|=
\begin{vmatrix}
a_{11} & a_{12} & \cdots & a_{1n} \\
\vdots & \vdots & 		& \\
ka_{i1} & ka_{i2} & \cdots & ka_{in} \\
\vdots & \vdots & 		 & \vdots \\
a_{n1} & a_{n2} & \cdots & a_{nn} \\
\end{vmatrix}
$$
按照完全展开式
$$
\begin{array}{ll}
|\mathbf{B}| &= \sum\limits_{j_1j_2\cdots j_n}(-1)^{\tau(j_1j_2\cdots j_n)} a_{1j_1}\cdots ka_{ij_i} \cdots a_{nj_n}\\
&=  k\sum\limits_{j_1j_2\cdots j_n}(-1)^{\tau(j_1j_2\cdots j_n)} a_{1j_1}\cdots a_{ij_i} \cdots a_{nj_n}
\end{array}
$$

{\color{red}(4)} 按照完全展开式
$$
\begin{array}{ll}
|\mathbf{A}| &= \sum\limits_{j_1j_2\cdots j_n}(-1)^{\tau(j_1j_2\cdots j_n)} a_{1j_1}\cdots (a_{ij_i}+b_{ij_i}) \cdots a_{nj_n}\\
&=  \sum\limits_{j_1j_2\cdots j_n}(-1)^{\tau(j_1j_2\cdots j_n)} a_{1j_1}\cdots a_{ij_i} \cdots a_{nj_n} + \sum\limits_{j_1j_2\cdots j_n}(-1)^{\tau(j_1j_2\cdots j_n)} a_{1j_1}\cdots b_{ij_i} \cdots a_{nj_n}
\end{array}
$$

{\color{red}(5)} 若考虑把第$i$行的$k$倍加第到$q$行，那么当且的完全展开式如下
$$
\begin{array}{ll}
|\mathbf{A}_1| &= \sum\limits_{j_1j_2\cdots j_n}(-1)^{\tau(j_1j_2\cdots j_n)} a_{1j_1}\cdots (a_{qj_q}+ka_{ij_i}) \cdots a_{nj_n}\\
&= \sum\limits_{j_1j_2\cdots j_n}(-1)^{\tau(j_1j_2\cdots j_n)} a_{1j_1}\cdots (a_{qj_q}) \cdots a_{nj_n} + k\sum\limits_{j_1j_2\cdots j_n}(-1)^{\tau(j_1j_2\cdots j_n)} a_{1j_1}\cdots a_{ij_i} \cdots (a_{ij_i}) \cdots a_{nj_n}\\
&= \sum\limits_{j_1j_2\cdots j_n}(-1)^{\tau(j_1j_2\cdots j_n)} a_{1j_1}\cdots (a_{qj_q}) \cdots a_{nj_n}
\end{array}
$$
\end{proof}

\begin{annotation}
\rm {\color{red} 行列式的几何意义} 给定两个向量$\begin{pmatrix}a_1 \\ a_2 \end{pmatrix}$及$\begin{pmatrix}b_1 \\ b_2 \end{pmatrix}$，且这两个向量不共线，则行列式
$$
\begin{vmatrix}
a_1 & b_1 \\
a_2 & b_2
\end{vmatrix}
$$
表示这两个向量张成的平行四边形的定向面积.
\end{annotation}

\newpage
\subsection{按行(列)展开}
\begin{definition}
\rm 在$n$阶行列式中划去$a_{ij}$所在的第$i$行和第$j$列，留下来的$n-1$阶行列式叫做$a_{ij}$的{\color{red}余子式}，记为$M_{ij}$; 称$(-1)^{i+j}M_{ij}$为{\color{red}代数余子式}，记为$A_{ij}$.
\end{definition}

\begin{lemma}
\rm 给定如下行列式
$$
\det(D)=
\begin{vmatrix}
a_{11} & 0 & \cdots & 0 \\
a_{21} & a_{22} & \cdots & a_{2n}\\
\vdots & \vdots &	&\vdots \\
a_{n1} & a_{n2} & \cdots & a_{nn}\\
\end{vmatrix},
$$
则$\det(D) = a_{11}A_{11}$.
\end{lemma}

\begin{proof}
这其实是很trivial的，其完全展开式如下
$$
\begin{array}{ll}
\det(D) &= \sum\limits_{j_1,j_2,\cdots,j_n} (-1)^{\tau(j_1j_2\cdots j_n)}a_{1j_1}a_{2j_2}\cdots a_{nj_n} \\
&= \sum\limits_{j_1=1,\cdots,j_n} (-1)^{\tau(j_1j_2\cdots j_n)}a_{1j_1}a_{2j_2}\cdots a_{nj_n} \\
&= a_{11} \sum\limits_{k_2,\cdots,k_n} (-1)^{\tau(k_2\cdots k_n)}a_{2k_2}\cdots a_{nk_n} \\
&= a_{11}(-1)^{1+1}M_{11}\\
&= a_{11}A_{11},
\end{array}
$$
其中$\tau(1j_2j_3\cdots j_n) = \tau(j_2j_3\cdots j_n)$，$k_2,k_3,\cdots,k_n$均不为$1$.
\end{proof}

\begin{lemma}
\rm 若给定$n$行列式$D$存在元素$a_{ij}$所在行元素除了它自己以外全为零，如下
$$
\det(D)=
\begin{vmatrix}
a_{11} & \cdots & a_{1j} & \cdots & a_{1n}\\
\vdots & & \vdots & & \vdots \\
0	& \cdots & a_{ij} & \cdots & 0 \\
\vdots & &\vdots & &\vdots \\
a_{n1} & \cdots & a_{nj} & \cdots & a_{nn} \\ 
\end{vmatrix}.
$$ 
则$\det(D)=a_{ij}A_{ij}$
\end{lemma}

% ^_^
\begin{proof}
考虑将第$i$行先向上移到第一行，再将第$j$列向左移动到第一列，还原到Lemma 2.8的情况下我们设为$D_1$. {\color{blue}注意这里是相邻移动，而不是直接将第一行和第$i$行的对换，第一列和第$j$列的替换，这样做的目的就是在将$a_{ij}$移动到$(1,1)$了之后，对应的$M_{11}$是和原来的$M_{ij}$相同的}. 所以现在我们只需要考虑在移动过程中对$D$的影响，向上移动了$i-1$，向左移动了$j-1$次，那么一共移动了$i+j-2$次，即
$$
D = (-1)^{i+j-2}D_1  = (-1)^{i+j-2} a_{ij}M_{ij} = a_{ij}A_{ij}.  
$$
\end{proof}

\begin{theorem}
\rm {\color{red} (按行(列)展开定理)} $n$阶行列式等于它的任一行(列)的各元素与其对应的代数余子式乘积的代数和，即
$$
\begin{array}{ll}
D = a_{i1}A_{i1} + a_{i2}A_{i2} + \cdots + a_{in}A_{in}, \; i=1,2,\cdots,n\\ \\
D = a_{1j}A_{1j} + a_{2j}A_{2j} + \cdots + a_{nj}A_{nj}, \; j=1,2,\cdots,n. 
\end{array}
$$
\end{theorem}

\begin{proof}
将$D$按第$i$行拆成$n$个行列式.
$$
\begin{array}{ll}
D &= \begin{vmatrix}
a_{11} & a_{12} & \cdots & a_{1n} \\
\vdots & \vdots & &\vdots \\
a_{i1}+0+\cdots+0 & 0+a_{i2}+\cdots+0 & \cdots & 0+0+\cdots+a_{in}\\
a_{n1} & a_{n2} &  \cdots & a_{nn} 
\end{vmatrix} \\
&= \begin{vmatrix}
a_{11} & a_{12} & \cdots & a_{1n} \\
\vdots & \vdots & &\vdots \\
a_{i1} & 0 & \cdots & 0\\
a_{n1} & a_{n2} &  \cdots & a_{nn} 
\end{vmatrix}
+ \begin{vmatrix}
a_{11} & a_{12} & \cdots & a_{1n} \\
\vdots & \vdots & &\vdots \\
0 & a_{i2} & \cdots & 0\\
a_{n1} & a_{n2} &  \cdots & a_{nn} 
\end{vmatrix}
+ \cdots 
+ \begin{vmatrix}
a_{11} & a_{12} & \cdots & a_{1n} \\
\vdots & \vdots & &\vdots \\
0 & 0 & \cdots & a_{in}\\
a_{n1} & a_{n2} &  \cdots & a_{nn} 
\end{vmatrix} \\
&= a_{i1}A_{i1} + a_{i2}A_{i2} + \cdots + a_{in}A_{in}.
\end{array}
$$
\end{proof}

\begin{theorem}\label{hls: zk2}
\rm $n$阶行列式的任一行(列)元素与另一行(列)元素的代数余子式乘积的代数和等于零，即
$$
a_{i1}A_{j1} + a_{i2}A_{j2} + \cdots + a_{in}A_{jn} = 0,\;(i\neq j).
$$
\end{theorem}


\begin{proof}
我们把给定行列式$D$的第$j$行特别地标注出来
$$
D=
\begin{vmatrix}
a_{11} & \cdots & a_{1n} \\
\vdots && \vdots \\
b_1 & \cdots & b_n \\
\vdots && \vdots \\
a_{n1} & \cdot & a_{nn} \\
\end{vmatrix}
$$
其中$b_1,\cdots,b_n$表示第$j$行，那么此时
$$
D = b_1A_{j1} + \cdots +b_nA_{jn}.
$$
我们再第$j$行用第$i$行换掉得到$D_1$，那么此时第$j$行各元素的代数余子式是没有发生变化的，且现在$D_1$是有两行相同的元素，所以
$$
D_1 = a_{i1}A_{j1} + \cdots + a_{in}A_{jn} = 0.
$$
同理也可以对第$j$列做上述操作.
\end{proof}

\newpage
\subsection{克拉默法则}

\begin{proposition}
\rm {\color{red} 行列式作为线性方程组解的判定条件} 给定$n$个$n$元线性方程的方程组，它有唯一解的充要条件其对应的系数矩阵的行列式不为零. 反之若其系数矩阵的行列式为零，则有无穷多个解或者有非零解.
\end{proposition}

\begin{corollary}
\rm 给定$n$个$n$元线性方程的齐次线性方程组，有零解当且仅当系数矩阵的行列式等于零. 反之若其系数矩阵行列式等于零则有非零解.
\end{corollary}

\begin{theorem}
\rm 给定$n$个$n$元线性方程的方程组的系数矩阵如下
$$
\mbf{A}=
\begin{pmatrix}
a_{11} & a_{12} & \cdots & a_{1n} \\
a_{21} & a_{22} & \cdots & a_{2n} \\
\vdots & \vdots & 		 & \vdots \\
a_{n1} & a_{n2} & \cdots & a_{nn} \\
\end{pmatrix},
$$
及其常数项为$\begin{pmatrix}b_1 \\ b_2 \\ \vdots \\b_n \end{pmatrix}$. 若$|\mbf{A}| \neq 0$，那么此线性方程组有唯一解，解可以为表示为
$$
x_1 = \frac{|\mbf{B}_1|}{|A|},x_2 = \frac{|\mbf{B}_2|}{|A|},\cdots, x_n = \frac{|\mbf{B_n}|}{|A|},
$$
其中$|\mbf{B}_i|$是把行列式$|\mbf{A}|$第$j$列换成方程常数项之后得到的行列式，即
$$
|\mbf{B}_j| = 
\begin{vmatrix}
a_{11} & \cdots & a_{1,j-1}  & b_1 & a_{1,j+1} & \cdots & a_{1n} \\
a_{21} & \cdots & a_{2,j-1}  & b_2 & a_{2,j+1} & \cdots & a_{2n} \\
\vdots &  & \vdots & \vdots &  \vdots & & \vdots \\
a_{n1} & \cdots & a_{n,j-1}  & b_n & a_{n,j+1} & \cdots & a_{nn} \\
\end{vmatrix},\; j=1,2,\cdots,n.
$$

\end{theorem}


\begin{proof}
下面将$(\frac{|\mbf{B}_1|}{|A|},\frac{|\mbf{B}_2|}{|A|},\cdots,\frac{|\mbf{B}_2|}{|A|})$带入原方程组，验证它的确是一个解. 首先将原方程组简写为
$$
\sum\limits_{j=1}^n a_{ij}x_j = b_i , \; i = 1,2,\cdots,n.
$$
那么
$$
\begin{array}{ll}
\sum\limits_{j=1}^n a_{ij}\frac{|\mbf{B}_j|}{|\mbf{A}|} &= \frac{1}{|\mbf{A}|}\sum\limits_{j=1}^n a_{ij}|\mbf{B}_j| \\
&= \frac{1}{|\mbf{A}|}\sum\limits_{j=1}^n a_{ij}\sum\limits_{s=1}^n b_sA_{sj} \\
&= \frac{1}{|\mbf{A}|}\sum\limits_{s=1}^n\sum\limits_{j=1}^n b_sa_{ij}A_{sj} ~  ~ ~ ~ ~\text{theorem \ref{hls: zk2}}\\ 
&= \frac{1}{|\mbf{A}|} b_i |\mbf{A}| = b_i.
\end{array}
$$
\end{proof}

\newpage
\subsection{Laplace展开}
\begin{definition}
\rm 在$n$阶行列式$|\mbf{A}|$中任意选定$k$行$k$列($k \leq n$)，位于这些行和列的交点上的$k^2$个元素按原来的次序组成的$k$阶行列式$M$，称为行列式$|\mbf{A}|$的{\color{red}$k$阶子式}，记做
$$
\mbf{A}\begin{pmatrix}
i_1,i_2,\cdots,i_k \\
j_1,j_2,\cdots,j_k
\end{pmatrix},
$$
其中$i_1 < i_2 < \cdots < i_k,\; j_1 < j_2 < \cdots < j_k$. 当$k < n$时，在$|\mbf{A}|$中划去这$k$行$k$列后余下的元素按照原来的次序组成的$n-k$阶行列式$M'$称为{\color{red}$k$阶子式$M$的余子式}，令
$$
\begin{array}{ll}
\{i_1',i_2',\cdots, i_{n-k}'\} = \{1,2,\cdots,n\}\setminus\{i_1,i_2,\cdots,i_k\}, \\
\{j_1',j_2',\cdots, j_{n-k}'\} = \{1,2,\cdots,n\}\setminus\{j_1,j_2,\cdots,j_k\},
\end{array}
$$
其中$i_1'< i_2'<\cdots < i_{n-k}',j_1' < j_2' < \cdots < j_{n-k}'$，则$M'$记为
$$
\mbf{A}\begin{pmatrix}
i_1',i_2',\cdots, i_{n-k}' \\
j_1',j_2',\cdots, j_{n-k}'
\end{pmatrix}.
$$
{\color{red}$M$的代数余子式}为
$$
(-1)^{(i_1+i_2+\cdots+i_k) + (j_1+j_2+\cdots+j_k)}M'.
$$
\end{definition}

\begin{lemma}\label{laplace: l1}
\rm $n$阶行列式$|\mbf{A}|$的任一个子式$M$与它的代数余子式$A$的乘积中的每一项都是行列式$|\mbf{A}|$的展开式中的一项，而且符号也一致.
\end{lemma}

\begin{proof}
首先考虑$M$位于$|\mbf{A}|$的左上角时，即
$$
\left|
\begin{array}{c:c}
\begin{matrix}
a_{11} & a_{12} & \cdots & a_{1k} \\
\vdots & \vdots & M & \vdots \\
a_{k1} & a_{k2} & \cdots & a_{kk} 
\end{matrix} &
\begin{matrix}
a_{1,k+1} & \cdots  & a_{1n} \\ 
\vdots &  & \vdots \\
a_{k,k+1} &  \cdots & a_{kn} 
\end{matrix} \\
\hdashline \\
\begin{matrix}
a_{k+1,1} & a_{k+1,2} & \cdots & a_{k+1,k} \\
\vdots & \vdots &  & \vdots \\
a_{n1} & a_{n2} & \cdots & a_{nk} 
\end{matrix} &
\begin{matrix}
a_{k+1,k+1} & \cdots  & a_{k+1,n} \\ 
\vdots & M' & \vdots \\
a_{k+1,k+1} &  \cdots & a_{k+1,n} 
\end{matrix} \\
\end{array} \right|
$$
此时$M$的代数余子式为
$$
A = (-1)^{(1+2+\cdots+k) + (1+2+\cdots+k)}M' = M'.
$$
$M$中的每一项记为
$$
(-1)^{\tau(\alpha_1\alpha_2\cdots\alpha_k)}a_{1\alpha_1}a_{1\alpha_2}\cdots a_{k\alpha_k},
$$
其中$\alpha_1\alpha_2\cdots\alpha_k$表示$1,2,\cdots,k$的一个排列.
$M'$中的每一项记为
$$
(-1)^{\tau(\beta_{k+1}\beta_{k+2}\cdots\beta_{n-k})}a_{k+1,\beta_{k+1}}a_{k+2,\beta_{k+2}}\cdots a_{n,\beta_{n-k}},
$$
其中$\beta_1\beta_2\cdots\beta_{n-k}$表示$k+1,k+2,\cdots,n$的一个排列. 那么它们的乘积的每一项可以表示为
$$
\begin{array}{ll}
=&(-1)^{\tau(\alpha_1\alpha_2\cdots\alpha_k) + \tau(\beta_{k+1}\beta_{k+2}\cdots\beta_{n-k})} a_{1\alpha_1}\cdots a_{k\alpha_k}a_{k+1,\beta_{k+1}}\cdots a_{n\beta_{n-k}} \\
=&(-1)^{\tau(\alpha_1\alpha_2\cdots\alpha_k\beta_{k+1}\beta_{k+2}\cdots\beta_{n-k})} a_{1\alpha_1}\cdots a_{k\alpha_k}a_{k+1,\beta_{k+1}}\cdots a_{n\beta_{n-k}},
\end{array}
$$
其中$\alpha_1,\alpha_1,\cdots,\alpha_k$均小于$\beta_{k+1},\beta_{k+2},\cdots,\beta_{n-k}$，因此乘积的每一项对应上了$|\mbf{A}|$中的一项. 

下面来证明一般情况. 设$M$位于$|\mbf{A}|$的第$i_1,i_2,\cdots,i_k$行，第$j_1,j_2,\cdots,j_k$行,这里有
$$
i_1 < i_2 < \cdots < i_k,j_1 < j_2 < \cdots < j_k.
$$
我们现将$M$重新变换到$|\mbf{A}|$的左上角，即将第$i_1$行向上移动至第1行，依次再将剩下的第$i_2,\cdots,i_k$也上移，同理也将第$j_1$列向左移动至第一列，依次再将剩下的第$j_2,\cdots,j_k$也左移. 那么总共行和列移动的次数为
$$
\begin{array}{ll}
=&(i_1-1)+(i_2-2)+\cdots+(i_k-k)+(j_1-1)+(j_2-2)+\cdots+(j_k-k)
\\
=&(i_1 + i_2 + \cdots + i_k) + (j_1 + j_2 + \cdots + j_k) + k(k+1),
\end{array}
$$
将移动之后的行列式记为$|\mbf{A}'|$，那么
$$
|\mbf{A}'| = (-1)^{(i_1 + i_2 + \cdots + i_k) + (j_1 + j_2 + \cdots + j_k)}|\mathbf{A}|,
$$
即$|\mathbf{A}'|$和$|\mathbf{A}|$中的对应项都只差一个符号. 同样现在$M\mathbf{A}$的每一项和$|\mathbf{A}'|$的一项$s$对应，那么就是和$|\mathbf{A}|$中的$(-1)^{(i_1 + i_2 + \cdots + i_k) + (j_1 + j_2 + \cdots + j_k)}s$一项对应.
\end{proof}

\begin{theorem}
\rm {\color{red} Laplace定理} 设在$n$阶行列式$|\mbf{A}|$中任意取定了$k$($1\leq k \leq n-1$)个行. 由这$k$行元素所构成一切$k$阶子式与它们的代数余子式的乘积的和等于行列式$|\mbf{A}|$.
\end{theorem}

\begin{proof}
设取定$k$行之后得到的所以子式为$M_1,M_2,\cdots M_t$，它们的余子式分别为$A_1,A_2,\cdots,A_t$，其中$t=C_n^k$. 定理要求证明
$$
|A| = M_1A_1 + M_2A_2 + \cdots + M_tA_t.
$$
根据lemma \ref{laplace: l1}，$M_iA_i$中每一项都是$|\mbf{A}|$中的一项，而且$M_iA_i$和$M_jA_j$($j \neq i$)无公共项. {\color{blue}因此我们只需要证明上述等式两边项数相等即可}. 左边已知有$n!$项，而右边每一项$M_iA_i$中有$(k)!(n-k)!$，那么一共有
$$
C_n^k (k)!(n-k)! = \frac{n!}{k!(n-k)!}(k)!(n-k)! = n!,
$$
即定理得证.

\newpage
{\color{blue}若我们舍弃上面构造性的证明手法，从行列式的完全展开式出发去理解laplace展开}. 首先我们取定$i_1 < i_2 < \cdots < i_k, i_1' < i_2 < \cdots < i_{n-k}'$，其中$\{i_1',i_2',\cdots, i_{n-k}'\} = \{1,2,\cdots,n\}\setminus\{i_1,i_2,\cdots,i_k\}$，那么可以将完全展开式写成
$$
\sum\limits_{\alpha_1,\alpha_2,\cdots,\alpha_k,\beta_1,\cdots,\beta_{n-k}}(-1)^{(i_1-1)+(i_2-2) +\cdots + (i_k-k) + \tau(\alpha_1\alpha_2\cdots\alpha_k\beta_1\beta_2\cdots \beta_{n-k})} a_{i_1\alpha_1}a_{i_2\alpha_2}\cdots a_{i_k\alpha_k}a_{i_1'\beta_1}a_{i_2'\beta_2}\cdots a_{i_{n-k}'\beta_{n-k}}.
$$
接下来我们将一个$\sum$分解成三个. 我们考虑先从选出第$j_1,j_2,\cdots,j_k$行，且$j_1 < j_2 < \cdots < j_k$，那么剩下第$j_1',j_2',\cdots,j_{n-k}'$行，且$j_1' < j_2' < \cdots < j_{n-k}'$. 然后我们从$j_1,j_2,\cdots,j_k$里面确定一个排列$\alpha_1\alpha_2\cdots\alpha_k$，再从$j_1',j_2',\cdots,j_{n-k}'$中确定一个排列$\beta_1\beta_2\cdots \beta_{n-k}$. 这样一来依然确定了原式中的一个$\alpha_1\alpha_2\cdots\alpha_k\beta_1\beta_2\cdots\beta_{n-k}$排列，即此时有
$$
\sum\limits_{1\leq j_1 < j_2 < \cdots < j_k \leq n} \sum\limits_{\alpha_1,\alpha_2,\cdots,\alpha_k} \sum\limits_{\beta_1,\beta_2,\cdots,\beta_{n-k}} S
$$
其中$S = (-1)^{(i_1-1)+(i_2-2) +\cdots + (i_k-k) + \tau(\alpha_1\alpha_2\cdots\alpha_k\beta_1\beta_2\cdots \beta_{n-k})} a_{i_1\alpha_1}a_{i_2\alpha_2}\cdots a_{i_k\alpha_k}a_{i_1'\beta_1}a_{i_2'\beta_2}\cdots a_{i_{n-k}'\beta_{n-k}}$. 下面再将指示符号拆开
$$
\begin{array}{ll}
(-1)^{(i_1-1)+(i_2-2) +\cdots + (i_k-k) + \tau(\alpha_1\alpha_2\cdots\alpha_k\beta_1\beta_2\cdots \beta_{n-k})} &= (-1)^{(i_1 + i_2 + \cdots + i_k) - \frac{k(k+1)}{2} + \tau(\alpha_1\alpha_2\cdots\alpha_k\beta_1\beta_2\cdots \beta_{n-k})} \\
&= (-1)^{(i_1 + i_2 + \cdots + i_k) - \frac{k(k+1)}{2}} \cdot \\
&~~~(-1)^{\tau(\alpha_1\alpha_2\cdots\alpha_k)}(-1)^{\tau(j_1j_2\cdots j_k\beta_1\beta_2\cdots\beta_{n-k})} \\
&= (-1)^{(i_1 + i_2 + \cdots + i_k)-\frac{k(k+1)}{2}} \cdot \\
&~~~(-1)^{(j_1 + j_2 + \cdots + j_k) - \frac{k(k+1)}{2}} \\
&~~~(-1)^{\tau(\alpha_1\alpha_2\cdots\alpha_k)}(-1)^{\tau(\beta_1\beta_2\cdots\beta_{n-k})}.
\end{array}
$$
最终展开式就可以写成
$$
\begin{array}{cl}
\sum\limits_{1\leq j_1 < j_2 < \cdots < j_k \leq n}&(-1)^{(i_1+i_2+\cdots+i_k)+(j_1+j_2+\cdots+j_k)} \\
\sum\limits_{\alpha_1,\alpha_2,\cdots,\alpha_k}&(-1)^{\tau(\alpha_1\alpha_2\cdots\alpha_k)}a_{i_1\alpha_1}a_{i_2\alpha_2}\cdots a_{i_k\alpha_k}\\ \sum\limits_{\beta_1,\beta_2,\cdots,\beta_{n-k}}& (-1)^{\tau(\beta_1\beta_2\cdots\beta_{n-k})} a_{i_1'\beta_1}a_{i_2'\beta_2}\cdots a_{i_{n-k}'\beta_{n-k}}
\end{array}
$$
{\color{blue}非常美妙!}
\end{proof}

\begin{corollary}
\rm 下式成立
$$
\begin{vmatrix}
a_{11} &\cdots &a_{1k} & 0 & \cdots & 0 \\
\vdots & \mbf{A} & \vdots & \vdots &  &\vdots\\
a_{k1} &\cdots& a_{kk} & 0 & \cdots & 0 \\
c_{11} &\cdots &c_{1k} & b_{11} & \cdots & b_{1r} \\
\vdots & \mbf{C} & \vdots & \vdots & \mbf{B} &\vdots \\
c_{r1} &\cdots& c_{rk} & b_{r1} & \cdots & b_{rr} \\
\end{vmatrix} = 
\begin{vmatrix}
a_{11} &\cdots &a_{1k} \\
\vdots & & \vdots  \\
a_{k1} &\cdots& a_{kk} \\
\end{vmatrix} \cdot
\begin{vmatrix}
b_{11} &\cdots &b_{1r} \\
\vdots & & \vdots  \\
b_{r1} &\cdots& b_{rr} \\
\end{vmatrix}(|\mbf{A}|\cdot|\mbf{B}|).
$$ 
\end{corollary}

\begin{proof}
利用laplace开展，选择前$k$行，那么只有在选择前$k$列的时候，其$k$阶子式才没有零列，此时余子式为右下方的$|\mbf{B}|$. 
\end{proof}


\newpage
\subsection{行列式的计算}
\begin{proposition}
\rm {\color{red} (几种特殊的行列式)}
\begin{enumerate}
	\item {\color{red}上(下)三角形行列式}
	$$
	\begin{vmatrix}
	a_{11} & & \bigzero\\
	a_{21} & a_{22} \\
	\vdots & \vdots & \ddots \\
	a_{n1} & a_{n2} & \cdots & a_{nn}
	\end{vmatrix} =
	\begin{vmatrix}
	a_{11} & a_{12} & \cdots & a_{1n}\\
	&	a_{22} & \cdots & a_{2n} \\
	&\bigzero& \ddots & \vdots \\
	&&& a_{nn} \\
	\end{vmatrix} = a_{11}a_{22}\cdots a_{nn}.
	$$
	\item {\color{red}对角行列式}
	$$
	\begin{vmatrix}
	a_{11} &&& \\
	&a_{22} &\bigzero& \\
	&\bigzero&\ddots& \\
	&&&a_{nn}
	\end{vmatrix} = a_{11}a_{22}\cdots a_{nn}.
	$$
\end{enumerate}
\end{proposition}

\newpage
\begin{example}
\rm 计算$n$阶行列式($n \geq 2$)
$$
\begin{vmatrix}
k & \lambda & \lambda & \cdots & \lambda \\
\lambda & k & \lambda & \cdots & \lambda \\
\lambda & \lambda & k & \cdots & \lambda \\
\vdots & \vdots & \vdots & \cdots & \lambda \\
\lambda & \lambda & \lambda & \cdots & k \\
\end{vmatrix}
$$
\hints\ 化阶梯型.
$$
\begin{array}{ll}
\begin{vmatrix}
k + (n-1)\lambda & \lambda & \lambda & \cdots & \lambda \\
k + (n-1)\lambda & k & \lambda & \cdots & \lambda \\
k + (n-1)\lambda & \lambda & k & \cdots & \lambda \\
\vdots & \vdots & \vdots & \cdots & \lambda \\
k + (n-1)\lambda & \lambda & \lambda & \cdots & k \\
\end{vmatrix} &= 
\left[ k + (n-1)\lambda \right]
\begin{vmatrix}
1 & \lambda & \lambda & \cdots & \lambda \\
1 & k & \lambda & \cdots & \lambda \\
1 & \lambda & k & \cdots & \lambda \\
\vdots & \vdots & \vdots & \cdots & \lambda \\
1 & \lambda & \lambda & \cdots & k \\
\end{vmatrix} \\ \\
& = 
\left[ k + (n-1)\lambda \right]
\begin{vmatrix}
1 & \lambda & \lambda & \cdots & 0 \\
0 & k-\lambda & 0 & \cdots & 0 \\
0 & 0 & k-\lambda & \cdots & 0 \\
\vdots & \vdots & \vdots & \cdots & 0 \\
0 & 0 & 0 & \cdots & k-\lambda \\ 
\end{vmatrix} \\ \\
& = \left[ k + (n-1)\lambda \right](k-1)^{n-1}
\end{array}
$$
\end{example}

\begin{example}
\rm 计算3阶行列式
$$
\begin{vmatrix}
1 & 1 & 1\\
a_1 & a_2 & a_3 \\
a_1^2 & a_2^2 & a_3^2 \\
\end{vmatrix}
$$
\hints\ 按第一列展开.
$$
\begin{array}{ll}
\begin{vmatrix}
1 & 1 & 1\\
a_1 & a_2 & a_3 \\
0 & a_2^2-a_1a_2 & a_3^2-a_1a_3 \\
\end{vmatrix} = 
\begin{vmatrix}
1 & 1 & 1\\
0 & a_2-a_1 & a_3-a_1 \\
0 & a_2^2-a_1a_2 & a_3^2-a_1a_3 \\
\end{vmatrix} &=
(a_2-a_1)(a_3-a_1)
\begin{vmatrix}
1 & 1 \\
a_2 & a_3
\end{vmatrix} \\
&= (a_2-a_1)(a_3-a_1)(a_3-a_2).
\end{array}
$$
%$$
%\begin{array}{ll}
%\begin{vmatrix}
%1 & 0 & 0\\
%a_1 & a_2-a_1 & a_3-a_1 \\
%a_1^2 & a_2^2-a_1^2 & a_3^2-a_1^2 \\
%\end{vmatrix} =
%(a_2-a_1)(a_3-a_1)
%\begin{vmatrix}
%1 & 1\\
%a_2+a_1 & a_3+a_1 \\
%\end{vmatrix}
%= (a_2-a_1)(a_3-a_1)(a_3-a_2).
%\end{array}
%$$
\end{example}

\begin{example}
\rm 计算$n$阶{\color{red}范德蒙行列式}($n \geq 2$)
$$
\begin{vmatrix}
1 & 1 & 1 & \cdots & 1\\
a_1 & a_2 & a_3 & \cdots & a_n \\
a_1^2 & a_2^2 & a_3^2 & \cdots & a_n^2 \\
\vdots& \vdots& \vdots& \vdots & \\
a_1^{n-1} & a_2^{n-1} & a_3^{n-1} & \cdots & a_n^{n-1} 
\end{vmatrix} = \prod\limits_{1 \leq i < j \leq n}(a_j-a_i).
$$
\hints\ 数学归纳法.
显然在$n=2$时成立，假设$n=k$时成立. 那么当$n=k+1$时，我们把第一列变成除了$a_{11}$其余全为$0$，变的方法是从最后一行开始，用第$i$行乘$a_1$消去第$i+1$的$a^i$，则有
$$
\begin{array}{ll}
=&\begin{vmatrix}
1 & 1 & 1 & \cdots & 1 & 1\\
a_1 & a_2 & a_3 & \cdots & a_k & a_{k+1} \\
a_1^2 & a_2^2 & a_3^2 & \cdots & a_k^2 & a_{k+1}^2\\
\vdots& \vdots& \vdots&  & \vdots &\vdots \\
a_1^{k-1} & a_2^{k-1}-a_1a_2^{k-2} & a_3^{k-1}-a_1a_3^{k-1} & \cdots & a_k^{k-1}-a_1a_k^{k-2} & a_{k+1}^{k-1} - a_1a_{k+1}^{k-2} \\
0 & a_2^{k}-a_1a_2^{k-2} & a_3^{k}-a_1a_3^{k} & \cdots & a_k^{k}-a_1a_k^{k-1} & a_{k+1}^{k} - a_1a_{k+1}^{k-1} 
\end{vmatrix} \\ \\
&\vdots \\ \\
=& 
\begin{vmatrix}
1 & 1 & 1 & \cdots & 1 & 1\\
0 & a_2-a_1 & a_3-a_1 & \cdots & a_k-a_1 & a_{k+1}-a_1 \\
0 & a_2(a_2-a_1) & a_3(a_3-a_1) & \cdots & a_k(a_k-a_1) & a_{k+1}(a_{k+1}-a_1) \\
\vdots& \vdots& \vdots &  & \vdots & \vdots \\
0 & a_2^{k-2}(a_2-a_1) & a_3^{k-2}(a_3-a_1) & \cdots & a_k^{k-2}(a_k - a_1) & a_{k+1}^{k-2}(a_{k+1}-a_1) \\
0 & a_2^{k-1}(a_2-a_1) & a_3^{k-1}(a_3-a_1) & \cdots & a_{k}^{k-1}(a_{k} - a_1) & a_{k+1}^{k-1}(a_{k+1}-a_1) \\
\end{vmatrix} \\ \\
=& (a_2-a_1)(a_3-a_1)\cdots(a_k-a_1)(a_{k+1}-a_1)
\begin{vmatrix}
1 & 1& \cdots & 1 & 1\\
a_2 & a_3 & \cdots & a_k & a_{k+1} \\
\vdots & \vdots& &\vdots &\vdots \\
a_2^{k-2} & a_3^{k-2} & \cdots & a_k^{k-2} & a_{k-1}^{k-2} \\
a_2^{k-1} & a_3^{k-1} & \cdots & a_k^{k-1} & a_{k-1}^{k-1} 
\end{vmatrix} \\
=& (a_2-a_1)(a_3-a_1)\cdots(a_k-a_1)(a_{k+1}-a_1) \prod\limits_{2\leq i < j \leq k+1}(a_j - a_i) \\
=& \prod\limits_{1 \leq i < j \leq k+1}(a_j - a_i)
\end{array}
$$
\end{example}

\newpage
\section{线性空间}

\subsection{线性空间的基本定义}

\begin{definition}
\rm 域$F$作用在一个阿贝尔群$G$上.
\end{definition}

\subsection{线性空间的基本性质}

\begin{proposition}
\rm 设$V$是数域$F$上的一个线性空间，则$V$的零元唯一.
\end{proposition}


\begin{proposition}
\rm 设$V$是数域$F$上的一个线性空间，则$v \in V$都有唯一的逆元.
\end{proposition}

\begin{proposition}
\rm 设$V$是数域$F$上的一个线性空间，则$v \in V$都有$0v=0$.
\end{proposition}

\begin{proposition}
\rm 设$V$是数域$F$上的一个线性空间，给定$a \in F$和$v \in V$. 若$av = 0$，则$a = 0$或者$v=\mbf{0}$.
\end{proposition}

\begin{proposition}
\rm 设$V$是数域$F$上的一个线性空间，则$v \in V$都有$(-1)v=-v$.
\end{proposition}

\subsection{子空间}

\begin{definition}
\rm 设$V$是数域$F$上的一个线性空间，给定$U$是$V$的一个子集. 若$U$中的元素在向量加法和数量下封闭，则称$U$是$V$的一个子空间（{\color{blue} 实际上这是一个proposition用于判定子空间的方法，让你不用考虑整个线性空间的定义}）.
\end{definition}

\subsection{线性组合和线性表出}

\begin{definition}
\rm 给定向量组$\mbf{v}_1,\mbf{v}_2,\cdots,\mbf{v}_n \in V$，任取$F$上一组数$a_1,a_2,\cdots,a_n$，称向量
$$
a_1\mbf{v}_1 + a_2\mbf{v}_2 + \cdots + a_n\mbf{v}_n
$$
为$\mbf{v}_1,\mbf{v}_2,\cdots,\mbf{v}_n$的一个线性组合. 取定$v \in V$，若存在$c_1,c_2,\cdots,c_n$使得
$$
v = c_1\mbf{v}_1 + c_2\mbf{v}_2 + \cdots + c_n\mbf{v}_n,
$$
则称$v$可以由$\mbf{v}_1,\mbf{v}_2,\cdots,\mbf{v}_n$线性表出. 
\end{definition}


\subsection{n元线性方程的线性表示}

\begin{definition}
\rm 给定$F$上$n$元线性方程组
$$
\left\{
\begin{array}{c}
a_{11}x_1 + a_{12}x_2 + \cdots a_{1n}x_n = b_1, \\
a_{21}x_1 + a_{22}x_2 + \cdots a_{2n}x_n = b_2, \\
\vdots \\
a_{m1}x_1 + a_{m2}x_2 + \cdots a_{mn}x_n = b_m, \\
\end{array} \right.
$$
则可以写成
$$
x_1 \begin{pmatrix}
a_{11} \\
a_{21} \\
\vdots \\
a_{m1} 
\end{pmatrix} + 
x_2 \begin{pmatrix}
a_{12} \\
a_{22} \\
\vdots \\
a_{m2} 
\end{pmatrix} +
\cdots +
x_n \begin{pmatrix}
a_{1n} \\
a_{2n} \\
\vdots \\
a_{mn}  
\end{pmatrix} = 
\begin{pmatrix}
b_1 \\
b_2 \\
\vdots \\
b_m  
\end{pmatrix} 
$$
即$x_1\mbf{\alpha}_1 + x_2\mbf{\alpha}_2 + \cdots + x_n\mbf{\alpha}_n = \beta $，其中${\alpha}_1,{\alpha}_2,\cdots,{\alpha}_n$表示该线性方程组系数矩阵的列向量组，$\beta$是由其常数项组成的列向量.
\end{definition}

\begin{annotation}
\rm {\color{red} 研究线性方程组解存在性的重要思路转换} $n$元线性方程组有解等价于$\beta$可以被${\alpha}_1,{\alpha}_2,\cdots,{\alpha}_n$线性表出. 更深刻一点，我们需要探究下述等式成立的条件
$$
\beta \overset{?}{\in} \text{span}({\alpha}_1,{\alpha}_2,\cdots,{\alpha}_n) 
$$
其中$\text{span}({\alpha}_1,{\alpha}_2,\cdots,{\alpha}_n)$是$F^{m,1}$的一个子空间，自然地后面需要子空间的一些结构和性质.
\end{annotation}

\subsection{线性相关和线性无关}

\begin{definition}
\rm 给定向量空间$V$上一组向量$\mbf{v}_1,\mbf{v}_2,\cdots,\mbf{v}_n$. 若存在一组不全为$0$的数$a_1, a_2, \cdots, a_n \in F$使得
$$
a_1\mbf{v}_1 + a_2\mbf{v}_2 + \cdots + a_n\mbf{v}_n = \mbf{0},
$$
则称$\mbf{v}_1,\mbf{v}_2,\cdots,\mbf{v}_n$是线性相关的. 反之只有在$a_1, a_2, \cdots, a_n$均为$0$上式成立，则称$\mbf{v}_1,\mbf{v}_2,\cdots,\mbf{v}_n$是线性无关的.
\end{definition}

\newpage
\subsection{线性相关和线性无关的性质}

\begin{proposition}
\rm 若$\mbf{v}_1,\mbf{v}_2,\cdots,\mbf{v}_n$ {\color{red}线性相关}，则下面结论均成立.
\begin{enumerate}
	\item {\color{red} 内部线性表出} $\mbf{v}_1,\mbf{v}_2,\cdots,\mbf{v}_n$至少有一个向量可以由其余的向量组表出;
	\item {\color{red} 齐次线性方程组} 若$\mbf{v}_1,\mbf{v}_2,\cdots,\mbf{v}_n$表示齐次线性方程的系数矩阵的列向量组，则该齐次方程组有非零解;
	\item {\color{red} 行列式} 以$\mbf{v}_1,\mbf{v}_2,\cdots,\mbf{v}_n$为行(列)向量组成的矩阵的行列式等于零;
	\item {\color{red} 线性表出任意向量} 若取定另外一个向量$v \in V$可以被$\mbf{v}_1,\mbf{v}_2,\cdots,\mbf{v}_n$线性表出，则表出方式有无穷种.
	\item {\color{red} 向量组与部分组的关系} 若取定另外一个向量$v \in V$，则$\mbf{v}_1,\mbf{v}_2,\cdots,\mbf{v}_n, v$也是线性相关.
	\item {\color{red} 缩短向量组} 若将$\mbf{v}_1,\mbf{v}_2,\cdots,\mbf{v}_n$中个每个向量都去掉相同位置的$m$个分量，则得到的新的向量组也是线性相关.
\end{enumerate}
\end{proposition}

\begin{proposition}
\rm 若$\mbf{v}_1,\mbf{v}_2,\cdots,\mbf{v}_n$线性无关，则下面结论均成立.
\begin{enumerate}
	\item {\color{red} 内部线性表出} $\mbf{v}_1,\mbf{v}_2,\cdots,\mbf{v}_n$中的每一个向量都不能被其余的向量组表出;
	\item {\color{red} 齐次线性方程组} 若$\mbf{v}_1,\mbf{v}_2,\cdots,\mbf{v}_n$表示齐次线性方程的系数矩阵的列向量组，则该齐次方程组只有零解;
	\item {\color{red} 行列式} 以$\mbf{v}_1,\mbf{v}_2,\cdots,\mbf{v}_n$为行(列)向量组成的矩阵的行列式不等于零;
	\item {\color{red} 线性表出任意向量} 若取定另外一个向量$v \in V$可以被$\mbf{v}_1,\mbf{v}_2,\cdots,\mbf{v}_n$线性表出，则表出方式唯一.
	\item {\color{red} 向量组与部分组的关系} 部分向量组$\mbf{v}_{i_1},\mbf{v}_{i_2},\cdots,\mbf{v}_{i_s}$也是线性无关. 
	\item {\color{red} 延伸向量组} 若将$\mbf{v}_1,\mbf{v}_2,\cdots,\mbf{v}_n$中个每个向量都新增相同位置的$m$个分量，则得到的新的向量组也是线性无关.
\end{enumerate}
\end{proposition}

\subsection{极大线性无关组}

\begin{definition}
\rm 给定某个向量组，其基数(向量个数)最大的线性无关的部分向量组称为极大线性无关组.
\end{definition}

\subsection{向量组的秩} 

\begin{definition}
\rm 向量组的极大线性无关组中所含向量的个数被称为该向量组的秩. 全体由零向量组成的向量组的值规定为$0$.
\end{definition}

\begin{lemma}\label{vectors-rank: lemma1}
\rm 设向量组$\mbf{v}_1,\mbf{v}_2,\cdots,\mbf{v}_n$可以由$\mbf{v}'_1,\mbf{v}'_2,\cdots,\mbf{v}'_m$线性表出，如果$n > m$，则$\mbf{v}_1,\mbf{v}_2,\cdots,\mbf{v}_n$线性相关.
\end{lemma}

\begin{proof}
如何优雅的证明这个lemma? 如果$\mbf{v}_1,\mbf{v}_2,\cdots,\mbf{v}_n$可以由$\mbf{v}'_1,\mbf{v}'_2,\cdots,\mbf{v}'_m$线性表出，那么
$$
\text{span}(\mbf{v}_1,\mbf{v}_2,\cdots,\mbf{v}_n) \subseteq \text{span}(\mbf{v}'_1,\mbf{v}'_2,\cdots,\mbf{v}'_m)
$$
于是$\dim \text{span}(\mbf{v}_1,\mbf{v}_2,\cdots,\mbf{v}_n) \leq \dim \text{span}(\mbf{v}'_1,\mbf{v}'_2,\cdots,\mbf{v}'_m) \leq m$. 所以当$n > m$时，$\mbf{v}_1,\mbf{v}_2,\cdots,\mbf{v}_n$是线性相关的.
\end{proof}

\begin{lemma}
\rm (\ref{vectors-rank: lemma1}的逆否命题) 设向量组$\mbf{v}_1,\mbf{v}_2,\cdots,\mbf{v}_n$可以由$\mbf{v}'_1,\mbf{v}'_2,\cdots,\mbf{v}'_m$线性表出，如果$\mbf{v}_1,\mbf{v}_2,\cdots,\mbf{v}_n$线性无关，则$n < m$.
\end{lemma}

\begin{proposition}
\rm 若向量组$\uppercase\expandafter{\romannumeral1}$可以由向量组$\uppercase\expandafter{\romannumeral2}$线性表出，那么
$$
\text{rank}~\uppercase\expandafter{\romannumeral1} \leq \text{rank}~\uppercase\expandafter{\romannumeral2}. 
$$
\end{proposition}

\begin{proof}
$\text{span}(\uppercase\expandafter{\romannumeral1}) \subseteq \text{span}(\uppercase\expandafter{\romannumeral2})$
\end{proof}

\begin{proposition}
\rm 线性无关组的秩和其向量组个数相等.
\end{proposition}


\subsection{有限维线性空间的基和维数}

\begin{definition}
\rm 给定向量空间$V$， 取其空间上一组向量$\mbf{v}_1,\mbf{v}_2,\cdots,\mbf{v}_n$若满足
\begin{enumerate}
	\item $\mbf{v}_1,\mbf{v}_2,\cdots,\mbf{v}_n$线性无关,
	\item $\forall \mbf{v} \in V$，$\mbf{v}$都可以被$\mbf{v}_1,\mbf{v}_2,\cdots,\mbf{v}_n$线性表出,
\end{enumerate}
则称$\mbf{v}_1,\mbf{v}_2,\cdots,\mbf{v}_n$为$V$的一个基.
\end{definition}

\begin{proposition}
\rm 向量空间上所有基所含向量的个数均相等.
\end{proposition}

\begin{definition}
\rm 向量空间一个基所含向量的个数被称为该向量空间的维数.
\end{definition}

\subsection{矩阵的秩}

\begin{definition}
\rm 矩阵的行向量生成的向量空间的维数为矩阵的行秩，同理矩阵的列向量生成的向量空间的维数为矩阵的列秩.
\end{definition}

\begin{lemma}
\rm 阶梯型矩阵的行秩和列秩相同.
\end{lemma}

\begin{lemma}
\rm 初等行变换不改变矩阵的行秩和列秩.
\end{lemma}

\begin{proposition}
\rm 矩阵的行秩和列秩相同.
\end{proposition}

\begin{corollary}
\rm 矩阵通过初等变换化成行阶梯形矩阵的非零个数就是矩阵的秩.
\end{corollary}

\begin{theorem}
\rm 矩阵的秩等于它的不为零的子式的最高阶数.
\end{theorem}


\begin{corollary}
\rm 矩阵的不为零的最高阶数的子式所在的行和列是原矩阵的行向量和列向量的极大线性无关组.
\end{corollary}


\begin{definition}
\rm $n$阶矩阵$\mbf{A}$的秩等于$n$，则称$\mbf{A}$是一个满秩矩阵.
\end{definition}

\begin{theorem}
\rm $n$阶矩阵$\mbf{A}$的秩等于$n$当且仅当$|\mbf{A}| \neq 0$.
\end{theorem}

\subsection{方程组有解的充要条件}


\begin{theorem}
\rm 给定任意$n$线性方程组(任意方程个数)
$$
x_1 \vect{\alpha}_1 + x_2 \vect{\alpha}_2 + \cdots + x_n \vect{\alpha}_n = \beta
$$
有解的充分必要条件是: 它的系数矩阵与增广矩阵的秩相同.
\end{theorem}

\begin{proof}
解的判定是看是否$\beta \in \text{span}(\alpha_1,\alpha_2,\cdots,\alpha_n)$. 
\end{proof}

\begin{theorem}
\rm 给定$n$元线性方程组有解时，如果它的系数矩阵$\mbf{A}$的秩等于$n$，那么原方程组有唯一解; 如果$\mbf{A}$的秩小于$n$，那么原方程组有无穷多个解.
\end{theorem}

\begin{corollary}
\rm 齐次线性方程组有非零解的条件是其系数矩阵的秩小于未知数的个数.
\end{corollary}

\subsection{齐次方程组解集结构}

\begin{proposition}
\rm $n$元齐次线性方程组的解集$\left\{\begin{pmatrix}
x_1\\
x_2\\
\vdots \\
x_n
\end{pmatrix}\right\}$构成$F^n$的一个子空间.
\end{proposition}

\begin{definition}
\rm 齐次线性方程组有非零解时，如果它的有限多个解$\eta_1,\eta_2,\cdots,\eta_t$满足
\begin{enumerate}
	\item $\eta_1,\eta_2,\cdots,\eta_t$线性无关;
	\item 该齐次线性方程组每一个解都可以由$\eta_1,\eta_2,\cdots,\eta_t$线性表出，
\end{enumerate}
那么就称$\eta_1,\eta_2,\cdots,\eta_t$是该齐次线性方程组的一个基础解系.
\end{definition}

\begin{theorem}
\rm $n$元齐次线性方程组的解空间的维数为
$$
\dim W = n - \text{rank}(\mbf{A}),
$$
其中$\mbf{A}$是它的系数矩阵.
\end{theorem}

\begin{proof}
分两种情况: 若$\rank{\mbf{A}} = n$，即原方程组只有零解，那么$W = {\mbf{0}}$. 自然地，命题中等式成立; 若$\rank{\mbf{A}} < n$.

(step 1) 把$\mbf{A}$通过初等行变换化成简化行阶梯形矩阵$J$，设$J$有$r$个主元，不妨设它们分别在$1,2,\cdots,r$列. 于是该齐次线性方程组的一般解为
$$
\left\{
\begin{array}{ll}
x_1 &= -b_{1,r+1}x_{r+1} - b_{1,r+2}x_{r+2} - \cdots - b_{1n} x_{n} \\
x_2 &= -b_{2,r+1}x_{r+1} - b_{2,r+2}x_{r+2} - \cdots - b_{2n} x_{n} \\
&\vdots \\
x_r &= -b_{r,r+1}x_{r+1} - b_{r,r+2}x_{r+2} - \cdots - b_{rn} x_{n}
\end{array}
\right.
$$
其中$x_{r+1},x_{r+2},\cdots,x_{n}$是自由变量.

(step 2) 让自由未知量$x_{r+1},x_{r+2},\cdots,x_{n}$分别取下述$n-r$组数
$$
\begin{pmatrix}
1 \\
0 \\
\vdots \\
0
\end{pmatrix},
\begin{pmatrix}
0 \\
1 \\
\vdots \\
0
\end{pmatrix},
\cdots,
\begin{pmatrix}
0 \\
0 \\
\vdots \\
1
\end{pmatrix},
$$
则由一般解得到原方程组的$n-r$解，设其为$\eta_1,\eta_2,\cdots,\eta_{n-r}$，其中
$$
\eta_1 = 
\begin{pmatrix}
-b_{1,r+1}\\
-b_{2,r+1}\\
\vdots\\
-b_{r,r+1}\\
1 \\
0 \\
\vdots \\
0
\end{pmatrix},
\cdots,
\eta_{n-r}
\begin{pmatrix}
-b_{1n}\\
-b_{2n}\\
\vdots\\
-b_{rn}\\
1 \\
0 \\
\vdots \\
0
\end{pmatrix}.
$$
上面两步是求一个基础解系的方法. 下面需要证明$\eta_1,\eta_2,\cdots,\eta_{n-r}$可以线性表出原线性方程组的所有解.
\end{proof}

\subsection{非齐次线性方程组解集结构}

\begin{lemma}
\rm 给定$n$元非齐次线性方程组，设它的解集为$U$. 若将其常数项都换成$0$变为齐次线性方程组，称其为原非齐次线性方程的导出组，设它的解集为$W$. 
\begin{enumerate}
	\item 对任意的$u_1, u_2 \in U$，有$u_1-u_1 \in W$.
	\item 对任意的$u \in U$和$w \in W$，有$u+w \in U$.
\end{enumerate}
\end{lemma}

\begin{proposition}
\rm {\color{red} affine set} 若$n$元非齐次线性方程组有解，那么它的解集$U$为
$$
U = \Set{u_0 + w}{ w \in W},
$$
其中$u_0$是取定$U$中的一个特解，$W$是原非齐次线性方程的导出组的解集. 
\end{proposition}

\newpage
\section{矩阵运算}

\subsection{矩阵运算的定义}

\begin{definition}
\rm 给定$F$上$m \times n$矩阵$\mbf{A}=(a_{ij})_{m \times n},\mbf{B}=(b_{ij})_{m \times n}$，则它们的加法定义为
$$
\mbf{A} + \mbf{B} = (a_{ij} + b_{ij})_{m \times n}.
$$
\end{definition}

\begin{definition}
\rm 给定$F$上$m\times n$矩阵$\mbf{A}=(a_{ij})_{m \times n}$和数$\lambda \in F$，则它们的数量乘法定义为
$$
\lambda\mbf{A} = (\lambda a_{ij})_{m \times n}.
$$
\end{definition}


\begin{proposition}
\rm 所有$m \times n$矩阵的集合记为$F^{m,n}$，则$F^{m,n}$构成一个向量空间.
\end{proposition}

\begin{definition}
\rm 给定$F$上$m \times n$矩阵$\mbf{A}=(a_{ij})_{m \times s},\mbf{B}=(b_{ij})_{s \times n}$，则它们的乘法定义为
$$
\mbf{A}\mbf{B} = \mbf{C},
$$
其中$\mbf{C}=(c_{ij})_{m\times n}$是一个$m \times n$矩阵，$\mbf{C}$的第$i$行和第$j$列为
$$
c_{ij} = \sum\limits_{r=1}^{s} a_{ir}b_{rj}. 
$$
\end{definition}

\subsection{矩阵运算的性质}

\begin{proposition}
\rm {\color{red}矩阵乘法的基本性质性质}
\begin{enumerate}
	\item 结合性\ 设$\mbf{A}=(a_{ij})_{m \times s},\mbf{B}=(b_{ij})_{s \times t},\mbf{C}=(c_{ij})_{t\times m}$，则$(\mbf{A}\mbf{B})\mbf{C} = \mbf{A}(\mbf{B}\mbf{C})$.
	\item 分配性\ 设$\mbf{A}=(a_{ij})_{m \times s},\mbf{B}=(b_{ij})_{s \times n},\mbf{C}=(c_{ij})_{s\times n}$，则$\mbf{A}(\mbf{B} + \mbf{C}) = \mbf{A}\mbf{B} + \mbf{A}\mbf{C}$.
\end{enumerate}
\end{proposition}

\begin{definition}
\rm 主对角线上元素都是$1$，其余元素均为$0$的$n$级矩阵称为$n$级单位矩阵，记为$\mbf{I}_n$，或者简记为$\mbf{I}$.
$$
\begin{pmatrix}
1 & 0 & \cdots & 0 \\
0 & 1 & \cdots & 0 \\
\vdots & \vdots & & \vdots \\
0 & 0 &\cdots & 1 \\
\end{pmatrix}
$$
\end{definition}

\begin{definition}
\rm $n$级矩阵的非负整数次幂定义为
$$
\begin{array}{ll}
\mbf{A}^m = \underbrace{\mbf{A} \cdot \mbf{A} \cdot \mbf{A} \cdots \mbf{A} }_{m\text{个}}, m \in \mathbb{Z}^+;\\
\mbf{A}^0 = \mbf{I}.
\end{array}
$$
\end{definition}

\begin{proposition}
\rm 矩阵加法，数量乘法和乘法与矩阵转置的关系如下
\begin{enumerate}
	\item $(\mbf{A} + \mbf{B})^T = \mbf{A}^T + \mbf{B}^T$;
	\item $(k\mbf{A})^T = k\mbf{A}^T$;
	\item $(\mbf{A}\mbf{B})^T = \mbf{B}^T \mbf{A}^T$.
\end{enumerate}
\end{proposition}

\begin{proof}
(3) 设$\mbf{A}=(a_{ij})_{m\times s},\mbf{B}=(b_{ij})_{s\times n}$，则
$$
\begin{array}{ll}
(\mbf{A}\mbf{B})^T(i;j) = \mbf{A}\mbf{B}(j;i) = \sum\limits_{r = 1}^s a_{jr}b_{ri} \\
(\mbf{B}^T\mbf{A}^T)(i;j) = \sum\limits_{r = 1}^s b'_{ir}a'_{rj} = \sum\limits_{r = 1}^s b_{ri}a_{jr},
\end{array}
$$
其中$b'_{ij}$表示$\mbf{B}^T(i;j)$.
\end{proof}

\subsection{矩阵乘法中的线性组合}

\begin{proposition}
\rm 设$\mbf{A}=(a_{ij})_{m \times s},\mbf{B}=(b_{ij})_{s \times n}$，把$\mbf{A}$列向量组记为$\alpha_1,\alpha_2,\cdots,\alpha_s$，则
$$
\mbf{A}\mbf{B} = \begin{pmatrix}
\alpha_1,\alpha_2,\cdots,\alpha_s
\end{pmatrix}\begin{pmatrix}
b_{11} & b_{12} & \cdots & b_{1n} \\
b_{21} & b_{22} & \cdots & b_{2n} \\
\vdots & \vdots & 		 & \vdots \\
b_{s1} & b_{s2} & \cdots & b_{sn} \\
\end{pmatrix} =
(b_{11}\alpha_1 + b_{21}\alpha_2 + \cdots + b_{s1}\alpha_s,\cdots, b_{1n}\alpha_1 + b_{2n}\alpha_2 + \cdots + b_{sn}\alpha_s).
$$
即$\mbf{A}\mbf{B}$每一个列向量都是$\mbf{A}$列向量组的线性组合.
\end{proposition}

\begin{definition}
\rm 设$\mbf{A}=(a_{ij})_{m \times s},\mbf{B}=(b_{ij})_{s \times n}$，把$\mbf{B}$行向量组记为$\begin{pmatrix}
\beta_1 \\ \beta_2 \\ \vdots \\ \beta_s
\end{pmatrix}$，则
$$
\mbf{A}\mbf{B} = \begin{pmatrix}
a_{11} & a_{12} & \cdots & a_{1s} \\
a_{21} & a_{22} & \cdots & a_{2s} \\
\vdots & \vdots & 		 & \vdots \\
a_{m1} & a_{s2} & \cdots & a_{ms} \\
\end{pmatrix} \begin{pmatrix}
\beta_1 \\ \beta_2 \\ \vdots \\ \beta_s
\end{pmatrix} = 
\begin{pmatrix}
a_{11}\beta_1 + a_{12}\beta_2 + \cdots + a_{1s}\beta_s \\
a_{21}\beta_1 + a_{22}\beta_2 + \cdots + a_{2s}\beta_s \\
\vdots \\
a_{m1}\beta_1 + a_{m2}\beta_2 + \cdots + a_{ms}\beta_s 
\end{pmatrix}.
$$
即$\mbf{A}\mbf{B}$每一个行向量都是$\mbf{B}$行向量组的线性组合.
\end{definition}

\begin{proposition}\label{matrix-mul: rank}
\rm 设$\mbf{A}=(a_{ij})_{m\times n},\mbf{B} = (b_{ij})_{m\times n}$，则
$$
\rank{\mbf{A}\mbf{B}} \leq \min\{\rank{\mbf{A}}, \rank{\mbf{B}}\}.
$$
\end{proposition}

\subsection{特殊矩阵}

\begin{definition}
\rm 只有一个元素是$1$，其余元素均为$0$的矩阵我们称为基本矩阵. $(i,j)$元为$1$的基本矩阵记为$\mbf{E}_{ij}$
\end{definition}

\begin{definition}
\rm 除对主角线以外的元素均为0的方阵称为对角矩阵.
$$
\begin{pmatrix}
d_1 & 0 & \cdots & 0 \\
0 & d_2 & \cdots & 0 \\
\vdots & \vdots & & \vdots \\
0 & 0 &\cdots & d_n \\
\end{pmatrix},
$$
记为$\text{diag}\{d_1,d_2,\cdots,d_n\}$.
\end{definition}

\begin{definition}
\rm 主对角线均为$\lambda$的对角矩阵称为数量矩阵.
$$
\begin{pmatrix}
\lambda & 0 & \cdots & 0 \\
0 & \lambda & \cdots & 0 \\
\vdots & \vdots & & \vdots \\
0 & 0 &\cdots & \lambda \\
\end{pmatrix},
$$
记为$\lambda \mbf{I}_{n}$.
\end{definition}

\begin{definition}
\rm  主对角线以下(上)均为$0$的方阵称为上(下)三角矩阵. 
$$
\begin{pmatrix}
a_{11} & a_{12} & \cdots & a_{1n} \\
0 & a_{22} & \cdots & a_{2n} \\
\vdots & \vdots & & \vdots \\
0 & 0 &\cdots & a_{nn} \\
\end{pmatrix},
$$
\end{definition}

\begin{definition}
\rm 由单位矩阵经过一次初等行(列)变换得到的矩阵称为初等矩阵，其对应3种初等变换如下(箭头之上表示初等行变换，箭头之下表示初等列变换)
\begin{enumerate}
	\item $\mbf{I}\xrightarrow{\tiny\textcircled{j} + k\tiny\textcircled{i}} P(j,i(k))$ 或者  $\mbf{I}\xrightarrow[\tiny\textcircled{i} + k\tiny\textcircled{j}]{} P(j,i(k))$,
	$$
		\bordermatrix{
		&\cr
		& 1 \cr
		& &\ddots	\cr
		i& & & 1 \cr
		& & & \vdots & \ddots	\cr
		j& & &  k& \cdots & 1	\cr
		& & & & & & \ddots	\cr
		& & & & & & & 1	\cr
		}
	$$
	\item $\mbf{I}\xrightarrow{(\tiny\textcircled{i},\tiny\textcircled{j})} P(i,j)$ 或者 $\mbf{I}\xrightarrow[(\tiny\textcircled{i},\tiny\textcircled{j})]{} P(i,j)$,
	$$
	\bordermatrix{
		&\cr
		& 1 \cr
		& &\ddots	\cr
		i& & & 0 & \cdots & 1\cr
		& & & \vdots & \ddots & \vdots	\cr
		j& & &  1& \cdots & 0	\cr
		& & & & & & \ddots	\cr
		& & & & & & & 1	\cr
		}
	$$
	\item $\mbf{I}\xrightarrow{\tiny\textcircled{i}\cdot \lambda} P(i(\lambda))$ 或者 $\mbf{I}\xrightarrow[\tiny\textcircled{j}\cdot \lambda]{}P(j(\lambda))$ ,
	$$
	\bordermatrix{
		&\cr
		& 1 \cr
		& &\ddots	\cr
		i& & & \lambda \cr
		& & &  & \ddots	\cr
		j& & &  &  & 1	\cr
		& & & & & & \ddots	\cr
		& & & & & & & 1	\cr
		}
	$$
\end{enumerate}
\end{definition}

\begin{theorem}
\rm 用初等矩阵左(右)乘一个矩阵$\mbf{A}$，就相当于$\mbf{A}$作了一次相应的初等行(列)变换.
\end{theorem}

\begin{proof}
设矩阵$\mbf{A}=(a_{ij})_{m\times n}$的行向量组为$\alpha_1,\alpha_2,\cdots,\alpha_m$，列向量组为$\gamma_1,\gamma_2,\cdots,\gamma_n$. 则对$\mbf{A}$左乘$P(j,i(k))$有
$$
P(j,i(k))A = \bordermatrix{
		&\cr
		& 1 \cr
		& &\ddots	\cr
		& & & 1 \cr
		& & & \vdots & \ddots	\cr
		& & &  k& \cdots & 1	\cr
		& & & & & & \ddots	\cr
		& & & & & & & 1	\cr
		} \begin{pmatrix}\alpha_1 \\ \alpha_2 \\ \vdots \\ \alpha_n \end{pmatrix} = \begin{pmatrix}\alpha_1 \\ \alpha_2 \\ \vdots\\ \alpha_j + k\alpha_i \\ \vdots \\ \alpha_n \end{pmatrix},
$$
同理对$\mbf{A}$右乘$P(j,i(k))$有
$$
AP(j,i(k)) = (\gamma_1,\gamma_2,\cdots,\gamma_m) \bordermatrix{
		&\cr
		& 1 \cr
		& &\ddots	\cr
		& & & 1 \cr
		& & & \vdots & \ddots	\cr
		& & &  k& \cdots & 1	\cr
		& & & & & & \ddots	\cr
		& & & & & & & 1	\cr
		} = (\gamma_1,\gamma_2,\cdots,\gamma_{i} + k\gamma_{j},\cdots,\gamma_m).
$$
其余两种变换都比较显然.
\end{proof}

\begin{definition}
\rm 一个矩阵$\mbf{A}$如果满足$\mbf{A}^T = \mbf{A}$，那么就称$\mbf{A}$是对称矩阵. 
\end{definition}

\begin{proposition}
\rm 对称矩阵是一个方阵，并且$n$级矩阵$\mbf{A}$是对称矩阵当且仅当
$$
A(i;j) = A(j;i), i,j = 1,2,\cdots,n.
$$
\end{proposition}

\begin{proposition}
\rm 若$\mbf{A},\mbf{B}$都是$n$级对称矩阵，则$\mbf{A}\mbf{B}$为对称矩阵当且仅当$\mbf{A}\mbf{B} = \mbf{B}\mbf{A}$.
\end{proposition}

\begin{proof}
$$
(\mbf{A}\mbf{B})^T = \mbf{B}^T\mbf{A}^T = \mbf{B}\mbf{A}.
$$
\end{proof}

\begin{definition}
\rm 一个矩阵$\mbf{A}$如果满足$\mbf{A}^T = -\mbf{A}$，那么称$\mbf{A}$是斜对角矩阵.
\end{definition}

\begin{proposition}
\rm 斜对角矩阵是一个方阵，并且$n$级矩阵$\mbf{A}$是斜对角矩阵当且仅当
$$
A(i;j) = -A(j;i), i,j = 1,2,\cdots,n.
$$
\end{proposition}

\begin{proposition}
\rm 奇数级斜对角矩阵的行列式等于$0$.
\end{proposition}

\begin{proof}
若$\mbf{A}^T = - \mbf{A}$，那么$|\mbf{A}^T| = |\mbf{A}| = |-\mbf{A}| = (-1)^n |\mbf{A}|$. 所以当$n$为奇数时，有$|\mbf{A}| = -|\mbf{A}| = 0$
\end{proof}

\subsection{可逆矩阵}

\begin{definition}
\rm 给定矩阵$\mbf{A}$，若存在矩阵$\mbf{B}$，使得
$$
\mbf{A}\mbf{B} = \mbf{B}\mbf{A} = \mbf{I},
$$
那么称$\mbf{A}$是一个可逆矩阵(非奇异矩阵). 若$\mbf{A}$是一个可逆矩阵，满足上式的$\mbf{B}$记为$\mbf{A}^{-1}$.
\end{definition}

\begin{proposition}
\rm 可逆矩阵一定是方阵.
\end{proposition}

\begin{proposition}\label{invertible: cond}
\rm $n$级矩阵$\mbf{A}$可逆当且仅当它的秩等于$n$(满秩矩阵)，即$|\mbf{A}| \neq 0$.
\end{proposition}

\begin{proof}
($\Rightarrow$)
$$
n =\rank{\mbf{I}} = \rank{\mbf{A}\mbf{A}^{-1}} \leq \rank{\mbf{A}} \leq n.
$$

($\Leftarrow$)
$$
\begin{pmatrix}
a_{11} & a_{12} & \cdots & a_{1n} \\
a_{21} & a_{22} & \cdots & a_{2n} \\
\vdots & \vdots &&\vdots \\
a_{n1} & a_{n2} & \cdots & a_{nn}
\end{pmatrix}
\begin{pmatrix}
A_{11} & A_{21} & \cdots & A_{n1} \\
A_{12} & A_{22} & \cdots & A_{n2} \\
\vdots & \vdots &&\vdots \\
A_{1n} & A_{2n} & \cdots & A_{nn}
\end{pmatrix}
=\begin{pmatrix}
|\mbf{A}| & 0 & \cdots & 0\\
0 & |\mbf{A}| & \cdots & 0\\
\vdots & \vdots &  & \vdots\\
0 & 0 & \cdots & |\mbf{A}|\\
\end{pmatrix},
$$
其中$A_{ij}$表示$|\mbf{A}|$的第$i$阶行，第$j$列的代数余子式.
\end{proof}

\begin{definition}
\rm 命题\ref{invertible: cond}中矩阵
$$
\begin{pmatrix}
A_{11} & A_{21} & \cdots & A_{n1} \\
A_{12} & A_{22} & \cdots & A_{n2} \\
\vdots & \vdots &&\vdots \\
A_{1n} & A_{2n} & \cdots & A_{nn}
\end{pmatrix}
$$
被称为$\mbf{A}$的伴随矩阵，记为$\mbf{A}^*$. 即有
$$
\mbf{A}\mbf{A}^* = |\mbf{A}|\mbf{I}~\text{和}~\mbf{A}^*\mbf{A} = |\mbf{A}|\mbf{I}.
$$
若$\mbf{A}$可逆时，那么$|\mbf{A}|$的逆矩阵记为
$$
\mbf{A}^{-1} = \frac{1}{|\mbf{A}|}\mbf{A}^*.
$$
\end{definition}

\begin{proposition}\label{invertible: prop1}
\rm 设$\mbf{A}$与$\mbf{B}$都是$n$级矩阵，若满足
$$
\mbf{A} \mbf{B} = \mbf{I},
$$
则$\mbf{A}$和$\mbf{B}$互为逆矩阵.
\end{proposition}

\begin{proof}
首先由
$$
n =\rank{\mbf{I}} =  \rank{\mbf{A} \mbf{B}} \leq \mbf{A} \leq n
$$
所以$\mbf{A}$是一个满秩矩阵，同理可证$\mbf{B}$也是一个满秩矩阵. 即$\mbf{A}$和$\mbf{B}$均可逆. 命题等式两边同时乘上$\mbf{A}^{-1}$
$$
\mbf{A}^{-1}\mbf{A}\mbf{B} = \mbf{A}^{-1}\mbf{I},
$$
即有$\mbf{B} = \mbf{A}^{-1}$，同理可证$\mbf{A} = \mbf{B}^{-1}$.
\end{proof}

\begin{proposition}\label{invertible: id}
\rm 初等矩阵都是可逆矩阵.
\end{proposition}

\begin{proof}
$$
\begin{array}{ll}
P(j,i(-k))P(j,i(k)) = \mbf{I},\\
P(i,j)P(i,j) = \mbf{I},\\
P(i(\frac{1}{\lambda}))P(i(\lambda)) = \mbf{I} 
\end{array}
$$
\end{proof}

\begin{proposition}\label{invertible: basic}
\rm 可逆矩阵基本性质
\begin{enumerate}
	\item 单位矩阵$\mbf{I}$可逆，$\mbf{I}^{-1} = \mbf{I}$;
	\item 如果$\mbf{A}$可逆，那么$\mbf{A}^{-1}$也可逆，且$(\mbf{A}^{-1})^{-1} = \mbf{A}$;
	\item 如果$n$级矩阵$\mbf{A},\mbf{B}$可逆，那么$\mbf{A}\mbf{B}$也可逆，且$(\mbf{A}\mbf{B})^{-1} = (\mbf{B}^{-1}\mbf{A}^{-1})$.该性质可以推广到2个以上$n$级矩阵. 
	\item 如果$\mbf{A}$可逆，那么$\mbf{A}^{T}$也可逆，并且$(\mbf{A}^T)^{-1} = (\mbf{A}^{-1})^T$.
\end{enumerate}
\end{proposition}

\begin{lemma}\label{invertible: 2id}
\rm 可逆矩阵经过初等矩阵行变换成的简化梯形矩阵一定是单位矩阵.
\end{lemma}

\begin{proof}
可逆矩阵是满秩矩阵，因此一定是单位矩阵.
\end{proof}

\begin{theorem}\label{invertible: decompose}
\rm 矩阵$\mbf{A}$可逆当且仅当它可以表示成一些初等矩阵的乘积.
\end{theorem}

\begin{proof}
($\Rightarrow$) 由lemma \ref{invertible: 2id}，可知存在初等矩阵$P_1,P_2,\cdots,P_t$，使得
$$
P_t\cdots P_2P_1\mbf{A} = \mbf{I}.
$$
因此由proposition \ref{invertible: prop1}可知$(P_t\cdots P_2P_1)$和$\mbf{A}$可逆，再有proposition \ref{invertible: id}和proposition \ref{invertible: basic}中的(3)有
$$
\mbf{A} = P_1^{-1}P_2^{-1}\cdots P_t^{-1}.
$$

($\Leftarrow$) 若$A = P_1'P_2'\cdots P_t'$，由proposition \ref{invertible: id}和proposition \ref{invertible: basic}中的(3)可知$(P_1'P_2'\cdots P_t')$可逆，即$\mbf{A}$可逆.
\end{proof}

\begin{proposition}
\rm 用一个可逆矩阵左(右)乘一个矩阵$\mbf{A}$，不改变$\mbf{A}$的秩.
\end{proposition}

\begin{proof}
可逆矩阵可以分解成多个初等矩阵的乘积，那么每个初等矩阵作用在$\mbf{A}$上等价于对$\mbf{A}$做初等变换，而初等变换不改变矩阵的秩. 
\end{proof}

\subsection{分块矩阵}

\begin{definition}
\rm 由矩阵$\mbf{A}$的若干行和若干列的交叉位置元素按原来顺序排成的矩阵称为$\mbf{A}$的子矩阵.
\end{definition}

\begin{definition}
\rm 把一个矩阵$\mbf{A}$的行分成若干组，列也分成若干组，从而$\mbf{A}$被分成了若干子矩阵，把$\mbf{A}$看成是由这些子矩阵组成的，这称为矩阵的分块. 这种由子矩阵组成的矩阵被称为分块矩阵.
\end{definition}

\begin{proposition}
\rm 设$\mbf{A}=(a_{ij})_{m \times s},\mbf{B}=(b_{ij})_{s \times n}$，则
$$
\begin{array}{ll}
&\begin{blockarray}{ccccc}
    & s_1    & s_2    & \cdots & s_t  \\
\begin{block}{c(cccc)}    
m_1 & A_{11} & A_{12} & \cdots & A_{1t} \\
m_2 & A_{21} & A_{22} & \cdots & A_{2t} \\
\vdots & \vdots & \vdots & 		 & \vdots \\
m_u & A_{u1} & A_{u2} & \cdots & A_{ut} \\
\end{block} 
\end{blockarray}~
\begin{blockarray}{ccccc}
n_1    & n_2    & \cdots & n_v  &\\
\begin{block}{(cccc)c}
B_{11} & B_{12} & \cdots & B_{1v} & s_1 \\
B_{21} & B_{22} & \cdots & B_{2v} & s_2 \\
\vdots & \vdots & 		 & \vdots & \vdots \\
B_{t1} & B_{t2} & \cdots & B_{tv} & s_t \\
\end{block}
\end{blockarray}\\
&= \begin{pmatrix}
\sum\limits_{r=1}^t A_{1r}B_{r1} & \cdots & \sum\limits_{r=1}^t A_{1r}B_{rv} \\
\sum\limits_{r=1}^t A_{2r}B_{r1} & \cdots & \sum\limits_{r=1}^t A_{2r}B_{rv} \\
\vdots && \vdots \\
\sum\limits_{r=1}^t A_{ur}B_{r1} & \cdots & \sum\limits_{r=1}^t A_{ur}B_{rv} 
\end{pmatrix}
\end{array}
$$
\end{proposition}

\begin{proof}
(1) 纯代数手法：直接比较分块矩阵乘法得到的$(i,j)$元和原常规矩阵乘法的$(i,j)$元. 棘手的地方在于你要确定$(i,j)$元在哪两个子矩阵乘积中.

(2) 递归分解：
$$
\begin{array}{ll}
&\begin{blockarray}{ccccc}
    & s_1    & s_2    & \cdots & s_t  \\
\begin{block}{c(c|ccc)}    
m_1 & A_{11} & A_{12} & \cdots & A_{1t} \\
m_2 & A_{21} & A_{22} & \cdots & A_{2t} \\
\vdots & \vdots & \vdots & 		 & \vdots \\
m_u & A_{u1} & A_{u2} & \cdots & A_{ut} \\
\end{block} 
\end{blockarray}~
\begin{blockarray}{ccccc}
n_1    & n_2    & \cdots & n_v  &\\
\begin{block}{(cccc)c}
B_{11} & B_{12} & \cdots & B_{1v} & s_1 \\
\BAhhline{----}
B_{21} & B_{22} & \cdots & B_{2v} & s_2 \\
\vdots & \vdots & 		 & \vdots & \vdots \\
B_{t1} & B_{t2} & \cdots & B_{tv} & s_t \\
\end{block}
\end{blockarray}\\
&= \begin{blockarray}{(c)}
A_{11} \\
A_{21} \\
\vdots \\
A_{u1} \\
\end{blockarray}
\begin{blockarray}{(cccc)}
B_{11} & B_{12} & \cdots & B_{1v} 
\end{blockarray}  + 
\begin{blockarray}{cccc}
    & s_2    & \cdots & s_t  \\
\begin{block}{c(c|cc)}    
m_1  & A_{12} & \cdots & A_{1t} \\
m_2  & A_{22} & \cdots & A_{2t} \\
\vdots & \vdots & 		 & \vdots \\
m_u  & A_{u2} & \cdots & A_{ut} \\
\end{block} 
\end{blockarray}~
\begin{blockarray}{ccccc}
n_1    & n_2    & \cdots & n_v  &\\
\begin{block}{(cccc)c}
B_{21} & B_{22} & \cdots & B_{2v} & s_2 \\
\BAhhline{----}
\vdots & \vdots & 		 & \vdots & \vdots \\
B_{t1} & B_{t2} & \cdots & B_{tv} & s_t \\
\end{block}
\end{blockarray}
\end{array}
$$
我们通过组合部分子矩阵构造了新的分块矩阵，所以我们只要证明两个更为简单的分块矩阵乘法即可，即
$$
\begin{blockarray}{(cc)}
A_1 & A_2
\end{blockarray} ~
\begin{blockarray}{(c)}
B_1 \\
B_2 \\
\end{blockarray}
= \begin{blockarray}{(c)}
A_1B_1 + A_2B_2
\end{blockarray}
$$
和
$$
\begin{blockarray}{(c)}
A_{1} \\
A_{2} \\
\vdots \\
A_{u} \\
\end{blockarray} ~
\begin{blockarray}{(cccc)}
B_{1} & B_{1} & \cdots & B_{v} 
\end{blockarray} = 
\begin{blockarray}{(cccc)}
A_{1}B_1 & A_{1}B_{2} & \cdots & A_{1}B_{v} \\
A_{2}B_1 & A_{2}B_{2} & \cdots & A_{2}B_{v} \\
\vdots & \vdots &  & \vdots \\
A_{u}B_1 & A_{u}B_{2} & \cdots & A_{u}B_{v} \\
\end{blockarray}
$$
相对来要所要比直接证明一般的分部矩阵乘法要稍微简单一点. 
\end{proof}

\newpage
\subsection{分块矩阵的初等变换}

\begin{proposition}
\rm 分块矩阵的初等行变换操作
\begin{enumerate}
	\item 把一个块行的{\color{red}左乘}$P$($P$是矩阵)倍加到另一个块行上，
	$$
	\begin{pmatrix}
	A_1 & A_2 \\
	A_3 & A_4
	\end{pmatrix}\xrightarrow{\tiny\textcircled{2} + P \cdot \tiny\textcircled{1}} 
	\begin{pmatrix}
	A_1 & A_2 \\
	PA_1+A_3 & PA_2 + A_4  
	\end{pmatrix}.
	$$
	\item 互换两个块行的位置，
	$$
	\begin{pmatrix}
	A_1 & A_2 \\
	A_3 & A_4
	\end{pmatrix}\xrightarrow{(\tiny\textcircled{1} ,  \tiny\textcircled{2})} 
	\begin{pmatrix}
	A_3 & A_4 \\
	A_1 & A_2   
	\end{pmatrix}.
	$$
	\item 用一个可逆矩阵{\color{red}左乘}某一块行,
	$$
	\begin{pmatrix}
	A_1 & A_2 \\
	A_3 & A_4
	\end{pmatrix}\xrightarrow{P\cdot \tiny\textcircled{2}} 
	\begin{pmatrix}
	PA_1 & PA_2 \\
	A_3 & A_4   
	\end{pmatrix}.
	$$
\end{enumerate}
\end{proposition}


\begin{proposition}
\rm 分块矩阵的初等列变换操作
\begin{enumerate}
	\item 把一个列行的{\color{red}右乘}$P$($P$是矩阵)倍加到另一个列行上，
	$$
	\begin{pmatrix}
	A_1 & A_2 \\
	A_3 & A_4
	\end{pmatrix}\xrightarrow[\tiny\textcircled{2} +  \tiny\textcircled{1}\cdot P ]{} 
	\begin{pmatrix}
	A_1 & A_1P+ A_2 \\
	A_3 & A_3P +A_4  
	\end{pmatrix}.
	$$
	\item 互换两个列行的位置，
	$$
	\begin{pmatrix}
	A_1 & A_2 \\
	A_3 & A_4
	\end{pmatrix}\xrightarrow[(\tiny\textcircled{1} ,  \tiny\textcircled{2})]{}
	\begin{pmatrix}
	A_2 & A_1 \\
	A_4 & A_3   
	\end{pmatrix}.
	$$
	\item 用一个可逆矩阵{\color{red}右乘}某一块列,
	$$
	\begin{pmatrix}
	A_1 & A_2 \\
	A_3 & A_4
	\end{pmatrix}\xrightarrow[P\cdot \tiny\textcircled{2}]{} 
	\begin{pmatrix}
	A_1 & A_2P \\
	A_3 & A_4P   
	\end{pmatrix}.
	$$
\end{enumerate}
\end{proposition}

\begin{definition}
\rm 把单位矩阵分块得到的矩阵经过一次分块矩阵的初等行(列)变换得到的矩阵被称为分块初等矩阵，如下
\begin{enumerate}
	\item 
	$$
	\begin{array}{ll}
	\begin{pmatrix} 
	\mbf{I} & 0 \\
	0 & \mbf{I} 
	\end{pmatrix}\xrightarrow{\tiny\textcircled{2} + P \cdot \tiny\textcircled{1}}
	\begin{pmatrix} 
	\mbf{I} & 0 \\
	P & \mbf{I}
	\end{pmatrix} \\ \\
	\begin{pmatrix} 
	\mbf{I} & 0 \\
	0 & \mbf{I} 
	\end{pmatrix}\xrightarrow[\tiny\textcircled{1} +  \tiny\textcircled{2} \cdot P]{}
	\begin{pmatrix} 
	\mbf{I} & 0 \\
	P & \mbf{I}
	\end{pmatrix}
	\end{array} 
	$$
	\item 
	$$
	\begin{array}{ll}
	\begin{pmatrix} 
	\mbf{I} & 0 \\
	0 & \mbf{I} 
	\end{pmatrix}\xrightarrow{(\tiny\textcircled{1} , \tiny\textcircled{2})}
	\begin{pmatrix} 
	0 & \mbf{I}  \\
	\mbf{I} & 0 
	\end{pmatrix} \\ \\
	\begin{pmatrix} 
	\mbf{I} & 0 \\
	0 & \mbf{I} 
	\end{pmatrix}\xrightarrow[(\tiny\textcircled{1} , \tiny\textcircled{2})]{}
	\begin{pmatrix} 
	0 & \mbf{I}  \\
	\mbf{I} & 0 
	\end{pmatrix}
	\end{array}
	$$
	\item
	$$
	\begin{array}{ll}
	\begin{pmatrix} 
	\mbf{I} & 0 \\
	0 & \mbf{I} 
	\end{pmatrix}\xrightarrow{P \cdot \tiny\textcircled{2}}
	\begin{pmatrix} 
	\mbf{I} & 0 \\
	0 & \mbf{P}
	\end{pmatrix} \\ \\
	\begin{pmatrix} 
	\mbf{I} & 0 \\
	0 & \mbf{I} 
	\end{pmatrix}\xrightarrow[\tiny\textcircled{2} \cdot P]{}
	\begin{pmatrix} 
	\mbf{I} & 0 \\
	0 & P
	\end{pmatrix}
	\end{array} 
	$$ 
\end{enumerate}
\end{definition}

\begin{theorem}
\rm 用分块初等矩阵左乘一个分块矩阵，就相当于对这个分块矩阵做了一次相应的分块矩阵的初等行变换. 同理用分块初等矩阵右乘一个分块矩阵，就相当于对这个分块矩阵做了一次相应的分块矩阵的初等列变换.
\end{theorem}

\begin{proof}
$$
\begin{array}{ll}
\begin{pmatrix} 
\mbf{I} & 0 \\
P & \mbf{I}
\end{pmatrix} 
\begin{pmatrix}
A_1 & A_2 \\
A_3 & A_4
\end{pmatrix}
=
\begin{pmatrix}
A_1 & A_2 \\
PA_1+A_3 & PA_2 + A_4 
\end{pmatrix} \\ \\
\begin{pmatrix}
A_1 & A_2 \\
A_3 & A_4
\end{pmatrix}
\begin{pmatrix} 
\mbf{I} & 0 \\
P & \mbf{I}
\end{pmatrix} 
=
\begin{pmatrix}
A_1 + A_2P & A_2 \\
A_3 + A_4P & A_4  
\end{pmatrix} \\ \\

\begin{pmatrix} 
 0 & \mbf{I}  \\
\mbf{I} & 0
\end{pmatrix} 
\begin{pmatrix}
A_1 & A_2 \\
A_3 & A_4
\end{pmatrix} = 
\begin{pmatrix}
A_3 & A_4\\
A_1 & A_2 
\end{pmatrix} \\ \\

\begin{pmatrix}
A_1 & A_2 \\
A_3 & A_4
\end{pmatrix} 
\begin{pmatrix} 
 0 & \mbf{I}  \\
\mbf{I} & 0
\end{pmatrix} = 
\begin{pmatrix}
A_2 & A_1\\
A_4 & A_3 
\end{pmatrix} \\ \\

\begin{pmatrix} 
\mbf{I} & 0 \\
0 & \mbf{P}
\end{pmatrix} 
\begin{pmatrix}
A_1 & A_2 \\
A_3 & A_4
\end{pmatrix}
=
\begin{pmatrix}
A_1 & A_2 \\
PA_3 & PA_4 
\end{pmatrix} \\ \\

\begin{pmatrix}
A_1 & A_2 \\
A_3 & A_4
\end{pmatrix}
\begin{pmatrix} 
\mbf{I} & 0 \\
0 & \mbf{P}
\end{pmatrix} 
=
\begin{pmatrix}
A_1 & A_2P \\
A_3 & A_4P 
\end{pmatrix}


\end{array}
$$
\end{proof}

\begin{theorem}
\rm 分块矩阵的初等行(列)变换不改变矩阵的秩.
\end{theorem}

\begin{proof}
初等分块矩阵都是可逆矩阵.
\end{proof}

\newpage
\subsection{矩阵乘积的秩和行列式}

\begin{lemma}
\rm 设$\mbf{A} = (a_{ij})_{n \times s},\mbf{B} = (b_{ij})_{s \times n}$，若$n  >  s$，则
$$
|\mbf{A}\mbf{B}| = 0.
$$
\end{lemma}

\begin{proof}
由proposition \ref{matrix-mul: rank}可知
$$
\rank{\mbf{A}\mbf{B}} < \rank{\mbf{B}} < s,
$$
而$\mbf{A}\mbf{B}$是一个$n \times n$矩阵，因此它不是满秩矩阵，即行列式等于$0$.
\end{proof}

\begin{lemma}
\rm 设$\mbf{A} = (a_{ij})_{n \times s},\mbf{B} = (b_{ij})_{s \times n}$，若$n  =  s$，则
$$
|\mbf{A}\mbf{B}| = |\mbf{A}||\mbf{B}|.
$$
\end{lemma}

\begin{proof}
下面分两种情况讨论:

若$|\mbf{A}| = 0$，那么$\mbf{A}$不是满秩，由proposition \ref{matrix-mul: rank}可知$|\mbf{A}\mbf{B}|$也不是满秩，即$|\mbf{A}\mbf{B}| = 0$.

若$|\mbf{A}| \neq 0$，那么$\mbf{A}$就可逆. 因此由proposition \ref{invertible: decompose}有
$$
\mbf{A} = P_1P_2\cdots P_t\mbf{I}, 
$$
其中$P_1,P_2,\cdots,P_t$是一些初等矩阵. 那么
$$
\mbf{A}\mbf{B} = (P_1P_2\cdots P_t)\mbf{B}.
$$
下面考虑三种左乘初等矩阵对矩阵$\mbf{B}$的行列式改变，即分三种情况
$$
\begin{array}{ll}
|P(j,i(k))\mbf{B}| = |\mbf{B}|\\
|P(i,j)\mbf{B}| = -|\mbf{B}| \\
|P(i(k))\mbf{B}| = k|\mbf{B}|
\end{array}
$$.
特别地，当上述$\mbf{B}$取单位矩阵$\mbf{I}$时，我们有
$$
\begin{array}{ll}
|P(j,i(k))\mbf{I}| = |P(j,i(k))| = |\mbf{I}| = 1\\
|P(i,j)\mbf{I}| = |P(i,j)| = -|\mbf{I}| = -1 \\
|P(i(k))\mbf{I}| = |P(i(k))| =k|\mbf{I}| = k
\end{array}
$$
于是
$$
\begin{array}{ll}
|P(j,i(k))\mbf{B}| =|P(j,i(k))| |\mbf{B}|\\
|P(i,j)\mbf{B}| = |P(i,j)||\mbf{B}| \\
|P(i(k))\mbf{B}| = |P(i(k))||\mbf{B}|
\end{array}
$$. 综上
$$
|\mbf{A}\mbf{B}| = |P_1P_2\cdots P_t\mbf{B}| = |P_1||P_2|\cdots |P_t||\mbf{B}|.
$$
特别地，当$\mbf{B} = \mbf{I}$时，
$$
|\mbf{A}| = |P_1||P_2|\cdots |P_t|,
$$
所以$|\mbf{A}\mbf{B}| = |\mbf{A}||\mbf{B}|$.
\end{proof}

\begin{theorem}
\rm {\color{red} Binet-Cauchy公式} 设$\mbf{A} = (a_{ij})_{n \times s},\mbf{B} = (b_{ij})_{s \times n}$，若$n \leq s$，则
$$
|\mbf{A}\mbf{B}| = \sum\limits_{1\leq v_1 < v_2 < \cdots <v_n \leq s} \mbf{A} \begin{pmatrix}
1,&2,&\cdots,&n \\
v_1,&v_2,&\cdots,&v_n
\end{pmatrix}\mbf{B} \begin{pmatrix}
v_1,&v_2,&\cdots,&v_n \\
1,&2,&\cdots,&n 
\end{pmatrix}.
$$
即$|\mbf{A}\mbf{B}|$等于$\mbf{A}$的所有$n$阶子式与$\mbf{B}$的相应$n$阶子式的乘积之和.
\end{theorem}

\begin{proof}
考虑特殊分块矩阵的行列值
$$
\begin{vmatrix}
\mbf{A} & 0 \\
\mbf{I}_n & \mbf{B} \\
\end{vmatrix} = |\mbf{A}||\mbf{B}|.
$$
对这个分块矩阵我们把2行的$-\mbf{A}$倍加到第一行上去就可以把$\mbf{A}\mbf{B}$构造出来，这个初等变换操作等价于
$$
\begin{pmatrix}
\mbf{I}_n & -\mbf{A} \\
0 & \mbf{I}_n
\end{pmatrix}
\begin{pmatrix}
\mbf{A} & 0 \\
\mbf{I}_n & \mbf{B} \\
\end{pmatrix} = 
\begin{pmatrix}
0 & -\mbf{A}\mbf{B} \\
\mbf{I}_n & \mbf{B} 
\end{pmatrix}
$$
\end{proof}

\newpage
\section{矩阵相似及二次型}

\subsection{内积和正交定义}
\begin{definition}
\rm 在$\mathbb{R}^n$中，任给$\mbf{\alpha}=(a_1,a_2,\cdots,a_n), \mbf{\beta} = (b_1,b_2,\cdots,b_n)$，规定
$$
\inp{\mbf{\alpha}}{\mbf{\beta}} = a_1b_1 + a_2b_2 + \cdots +a_nb_n,
$$
$\inp{\mbf{\alpha}}{\mbf{\beta}}$是$\mbf{\alpha}$和$\mbf{\beta}$的内积(实际上就是一个二元的线性泛函). 通常可以写作
$$
\inp{\mbf{\alpha}}{\mbf{\beta}} = \mbf{\alpha}\mbf{\beta}^{T}.
$$
\end{definition}

\begin{proposition}
\rm 内积的基本性质如下
\begin{enumerate}
	\item 对称性 $\inp{\mbf{\alpha}}{\mbf{\beta}} = \inp{\mbf{\beta}}{\mbf{\alpha}}$;
	\item 线性可加 $\inp{\mbf{\alpha}+\mbf{\gamma}}{\mbf{\beta}} = \inp{\mbf{\alpha}}{\mbf{\beta}} + \inp{\mbf{\gamma}}{\mbf{\beta}}$;
	\item 线性齐次 $\inp{\lambda\mbf{\alpha}}{\mbf{\beta}} = \lambda \inp{\mbf{\alpha}}{\mbf{\beta}}$;
	\item 正定性 $\inp{\mbf{\alpha}}{\mbf{\alpha}} \geq 0$，等号成立当且仅当$\mbf{\alpha} = \mbf{0}$.
\end{enumerate}
\end{proposition}

\begin{definition}
\rm 向量空间$\mathbb{R}^n$有了内积之后，就称$\mathbb{R}^n$为一个欧几里得空间(Euclidean space).
\end{definition}

\begin{definition}
\rm 在欧几里得空间$\mathbb{R}^n$中，向量$\mbf{\alpha}$的长度$\norm{\mbf{\alpha}}$规定为
$$
\norm{\mbf{\alpha}} = \sqrt{\inp{\mbf{\alpha}}{\mbf{\alpha}}}.
$$
长度为$1$的向量称为单位向量. 
\end{definition}

\begin{lemma}
$$
|\lambda \mbf{\alpha}| = |\lambda||\mbf{\alpha}|.
$$
\end{lemma}

\begin{definition}
\rm 把非零向量$\mbf{\alpha}$乘上$\frac{1}{\norm{\mbf{\alpha}}}$称为把$\mbf{\alpha}$单位化.
\end{definition}

\begin{definition}
\rm 在欧几里得空间$\mathbb{R}^n$中，如果$\inp{\mbf{\alpha}}{\mbf{\alpha}}=0$，那么称$\mbf{\alpha}$和$\mbf{\beta}$是正交，记做$\mbf{\alpha} \perp \mbf{\beta}$. 显然零向量与任何向量都正交.
\end{definition}

\begin{definition}
\rm 在欧几里得空间$\mathbb{R}^n$中，由非零向量组成的向量组如果其中每两个不同的向量都正交，那么称它们为正交向量组. 如果正交向量组的每个向量都是单位向量，那么称它为正交单位向量组.
\end{definition}

\newpage
\begin{proposition}
\rm 在欧几里得空间$\mathbb{R}^n$中，正交向量组一定是线性无关的.
\end{proposition}

\begin{proof}
设$\mbf{\alpha}_1,\mbf{\alpha}_2,\cdots,\mbf{\alpha}_t$是正交向量组. 设有$k_1,k_2,\cdots,k_t$使得
$$
k_1\mbf{\alpha}_1 + k_2\mbf{\alpha}_2 + \cdots + k_t\mbf{\alpha}_t = \mbf{0},
$$
等式两边同时分别取关于$\mbf{\alpha}_i$ ($1\leq i \leq t$)的内积，当$i \neq j$均有$\inp{\mbf{\alpha}_i}{\mbf{\alpha}_j} = \mbf{0}$，于是$k_i\inp{\mbf{\alpha}_i}{\mbf{\alpha}_i} = 0$，即$k_i = 0, 1 \leq i \leq t$.
\end{proof}

\begin{definition}
\rm 在欧几里得空间$\mathbb{R}^n$中，$n$个向量组成的正交向量组一定是$\mathbb{R}^n$的一个基，称它为正交基. $n$个单位向量组成的正交向量组称为$\mathbb{R}^n$的一个标准正交基.
\end{definition}

\begin{theorem}
\rm {\color{red}施密特(Schmit)正交化} 设$\mbf{\alpha}_1,\mbf{\alpha}_2,\cdots,\mbf{\alpha}_t$是欧几里得空间$\mathbb{R}^n$中的一个线性无关的向量组，令
$$
\begin{array}{ll}
\mbf{\beta}_1 = \mbf{\alpha}_1 \\
\mbf{\beta}_2 = \mbf{\alpha}_2 - \frac{\inp{\mbf{\alpha}_2}{\mbf{\beta}_1}}{\inp{\mbf{\beta}_1}{\mbf{\beta}_1}}\mbf{\beta}_1\\
\cdots \\
\mbf{\beta}_t = \mbf{\alpha}_t - \sum\limits_{i = 1}^{t-1}\frac{\inp{\mbf{\alpha}_t}{\mbf{\beta}_i}}{\inp{\mbf{\beta}_i}{\mbf{\beta}_i}}\mbf{\beta}_i
\end{array},
$$
则$\mbf{\beta}_1,\mbf{\beta}_2,\cdots,\mbf{\beta}_t$是正交向量组，并且$\mbf{\beta}_1,\mbf{\beta}_2,\cdots,\mbf{\beta}_t$与$\mbf{\alpha}_1,\mbf{\alpha}_2,\cdots,\mbf{\alpha}_t$等价. 自然地，$\frac{\mbf{\beta}_1}{\norm{\mbf{\beta}_1}},\frac{\mbf{\beta}_2}{\norm{\mbf{\beta}_2}},\cdots,\frac{\mbf{\beta}_t}{\norm{\mbf{\beta}_t}}$是正交单位向量组.
\end{theorem}

\begin{proof}
对所给定的线性无关的向量组所含向量个数进行归纳. 当$s = 1$时，$\mbf{\beta}_1 = \mbf{\alpha}_1$是正交向量组，且$\mbf{\beta}_1$和$\mbf{\alpha}_1$等价. 假设在$s = k$时成立，那么当$s = k+1$时，有

\begin{equation}
\mbf{\beta}_{k+1} = \mbf{\alpha}_{k+1} - \sum\limits_{i = 1}^{k}\frac{\inp{\mbf{\alpha}_{k+1}}{\mbf{\beta}_i}}{\inp{\mbf{\beta}_i}{\mbf{\beta}_i}}\mbf{\beta}_i,
\end{equation}

因此当$1\leq j \leq k$时，有
$$
\inp{\mbf{\beta}_{k+1}}{\mbf{\beta}_{j}} = \inp{\mbf{\beta}_{k+1}}{\mbf{\beta}_{j}}-\sum\limits_{i = 1}^{k}\frac{\inp{\mbf{\alpha}_{k+1}}{\mbf{\beta}_i}}{\inp{\mbf{\beta}_i}{\mbf{\beta}_i}}\inp{\mbf{\beta}_i}{\mbf{\beta}_j} = \inp{\mbf{\beta}_{k+1}}{\mbf{\beta}_{j}} - \inp{\mbf{\beta}_{k+1}}{\mbf{\beta}_{j}} = 0.
$$
所以$\mbf{\beta}_{k+1}$和$\mbf{\beta}_{j}$均正交. 观察(1)式可知$\mbf{\beta}_{k+1}$是由$\mbf{\alpha}_1,\mbf{\alpha}_2,\cdots,\mbf{\alpha}_t$线性表出的，并且$\mbf{\alpha}_k$的系数为1，所以$\mbf{\beta}_{k+1}$不为$\mbf{0}$. 于是$\mbf{\beta}_{1},\cdots,\mbf{\beta}_{k},\mbf{\beta}_{k+1}$为正交向量组. 还是由(1)式$\mbf{\beta}_{1},\cdots,\mbf{\beta}_{k},\mbf{\beta}_{k+1}$和$\mbf{\alpha}_{1},\cdots,\mbf{\alpha}_{k},\mbf{\alpha}_{k+1}$显然是等价.
\end{proof}

\subsection{正交矩阵}

\begin{definition}
\rm 如果$n$阶矩阵$\mbf{A}$满足
$$
\mbf{A}\mbf{A}^T = \mbf{I},
$$
则称$\mbf{A}$是正交矩阵. 
\end{definition}

\begin{proposition}
\rm 下述性质是相互等价的(互为充要条件).
\begin{enumerate}
	\item $n$阶矩阵$\mbf{A}$是正交矩阵;
	\item $\mbf{A}\mbf{A}^T = \mbf{I}$;
	\item $\mbf{A}$可逆，且$\mbf{A}^{-1} = \mbf{A}^T$;
	\item $\mbf{A}^T\mbf{A} = \mbf{I}$. 
\end{enumerate}
\end{proposition}

\begin{proof}
从正交矩阵的定义，由proposition \label{invertible: prop1}直接可知$\mbf{A}$和$\mbf{A}^T$互为逆矩阵，因此上面的性质都很显然. 特别地，设$\mbf{A}$的行向量为$\alpha_1,\alpha_2,\cdots,\alpha_n$，那么按照正交矩阵的定义
$$
\begin{pmatrix}
\alpha_1 \\
\alpha_2 \\
\vdots \\
\alpha_n 
\end{pmatrix}
\begin{pmatrix}
\alpha_1^T & \alpha_2^T & \cdots & \alpha_n^T
\end{pmatrix} = \mbf{I}.
$$
它给定的关系式就是
$$
\alpha_i\alpha_j^T = \left\{ 
\begin{array}{ll}
1 & i=j,\\
0 & i\neq j
\end{array}
\right.
$$
\end{proof}

\begin{proposition}\label{orthogonal-matrix: basis}
\rm 设$\eta_1,\eta_2,\cdots,\eta_n$是欧几里得空间$\mathbb{R}^n$的一个标准正交基，则以它们为行向量的矩阵
$$
\begin{pmatrix}
\eta_1 \\
\eta_2 \\
\vdots \\
\eta_n \\
\end{pmatrix}
$$
是一个正交矩阵.
\end{proposition}

\begin{proposition}
\rm 正交矩阵具有下列性质
\begin{enumerate}
	\item $\mbf{I}$是正交矩阵;
	\item 若$\mbf{A}$和$\mbf{B}$都是$n$阶正交矩阵，则$\mbf{A}\mbf{B}$也是正交矩阵;
	\item 若$\mbf{A}$是正交矩阵，则$\mbf{A}^{-1}$也是正交矩阵;
	\item 若$\mbf{A}$是正交矩阵，则$|\mbf{A}| = 1$或者$-1$.
\end{enumerate}
	
\begin{proof}

\end{proof}
(1)(3)是显然的. 若$\mbf{A}$是正交矩阵，那么
$$
|\mbf{A}\mbf{A}^T| =|\mbf{A}||\mbf{A}^T| = |\mbf{A}|^2 = |I|,
$$
所以$|\mbf{A}|=1$或者$\mbf{A}=-1$，即(4)得证. 若$\mbf{A}$和$\mbf{B}$都是$n$阶矩阵，那么
$$
\mbf{A}\mbf{B}(\mbf{A}\mbf{B})^T = \mbf{A}\mbf{B}\mbf{B}^T\mbf{A}^T = \mbf{I},
$$
即(2)得证. 
\end{proposition}

\subsection{正交变换}

\subsection{矩阵的特征值和特征向量}

\begin{definition}
\rm 设$\mbf{A}$是一个$n$阶矩阵，如果数$\lambda$和$n$维非零列向量$\mbf{\alpha}$使得
\begin{equation}
\mbf{A}\mbf{\alpha} = \lambda\mbf{\alpha}
\end{equation}
成立. 那么称$\lambda$为矩阵$\mbf{A}$的特征值，非零向量$\mbf{\alpha}$称为矩阵$\mbf{A}$的对应于特征值$\lambda$的一个特征向量. (1)式可以改写为
\begin{equation}
(\mbf{A}-\lambda\mbf{I})\mbf{\alpha} = 0,
\end{equation}
这个等式可以看做一个$n$个未知数和$n$和方程的齐次线性方程组$(\mbf{A}-\lambda\mbf{I})\mbf{X} = 0$，这个方齐次线性方程被称为$\mbf{A}$的特征方程. 把$|\mbf{A}-\lambda\mbf{I}|$称为$\mbf{A}$的特征多项式，$|\mbf{A}-\lambda\mbf{I}|$写作
$$
|\mbf{A}-\lambda\mbf{I}| = 
\begin{pmatrix}
a_{11} - \lambda & a_{12} & \cdots & a_{1n} \\
a_{21} & a_{21} - \lambda & \cdots & a_{2n} \\
\vdots & \vdots && \vdots \\
a_{n1} & a_{n2} & \cdots & a_{nn}-\lambda 
\end{pmatrix}
$$
\end{definition}

\begin{lemma}
\rm 若$\mbf{\alpha}$是$\mbf{A}$的对应于特征值$\lambda$的一个特征向量，那么$k\mbf{\alpha}$也是$\mbf{A}$的对应于特征值$\lambda$的一个特征向量. 
\end{lemma}

\begin{proof}
$$
\mbf{A}(k\mbf{\alpha}) = k(\mbf{A}\mbf{\alpha}) = k(\lambda\mbf{\alpha}) = \lambda(k\mbf{\alpha}).
$$
\end{proof}


\begin{proposition}
\rm $\mbf{A}$的特征值$\lambda$就是特征多项式的根.
\end{proposition}

\begin{proof}
\rm (2)式要有非零解的充要条件是$|\mbf{A}-\lambda\mbf{I}| = 0$，而$|\mbf{A}-\lambda\mbf{I}|$是关于$\lambda$的一个多项式，因此所求$\lambda$就是特征多项式的根.
\end{proof}

\begin{proposition}
\rm $\mbf{A}$的特征向量$\mbf{\alpha}$是齐次线性方程$(\mbf{A}-\lambda\mbf{I})\mbf{X} = 0$的一个非零解.
\end{proposition}

\begin{annotation}
\rm 求$\mbf{A}$的全部特征值和特征向量的方法如下
\begin{enumerate}
	\item 计算$\mbf{A}$的特征多项式$|\mbf{A}-\lambda\mbf{I}|$,
	\item 如果多项式$|\mbf{A}-\lambda\mbf{I}|$在数域$F$(实数域和复数域)中没有根，那么$\mbf{A}$没有根. 如果 如果多项式$|\mbf{A}-\lambda\mbf{I}|$在数域$F$中有根，那么它在$F$中的全部根就是$\mbf{A}$的特征值，此时再做第3步.
	\item 对$\mbf{A}$的每一个特征值$\lambda_i$，求齐次线性方程组$(\mbf{A}-\lambda_i\mbf{I})\mbf{X} = 0$的一个基础解系$\eta_1,\eta_2,\cdots,\eta_t$. 于是$\mbf{A}$的对应于特征值$\lambda_i$的全部特征向量组成的集合是
$$
\Set{k_1\eta_1 + k_2\eta_2 + \cdots + k_t\eta_t}{k_1,k_2,\cdots,k_t \in F, ~\text{且它们不全为}~0}.
$$
\end{enumerate}
\end{annotation}

\begin{definition}
\rm 设$\lambda$是$n$阶$\mbf{A}$的一个特征值，把齐次方程组$(\mbf{A}-\lambda\mbf{I})\mbf{X} = 0$的解空间称为$\mbf{A}$的对应于$\lambda$的特征子空间.
\end{definition}

\begin{proposition}
\rm 设$\lambda$是$n$阶$\mbf{A}$的一个特征值，则下述命题成立
\begin{enumerate}
	\item $\lambda^m$是$\mbf{A}^m$的特征值;
	\item 当$\mbf{A}$可逆时，则$\frac{1}{\lambda}$是$\mbf{A}^{-1}$的特征值.
\end{enumerate}
\end{proposition}

\begin{definition}
\rm 设$\mbf{A}$是一个$n$阶行列式，$\lambda_1$是$\mbf{A}$的一个特征值. 把$\mbf{A}$的对应于$\lambda_1$的特征子空间的维数叫做特征值$\lambda_1$的几何重数. 而把$\lambda_1$作为$\mbf{A}$的特征多项式的根的重数叫做$\lambda_1$的代数重数，代数重数简称重数.
\end{definition}

\begin{proposition}
\rm 设$\lambda_1$是$n$阶矩阵$\mbf{A}$的一个特征值，则$\lambda_
1$的几何重数不超过它的代数重数.
\end{proposition}

\begin{proof}
证明思路就是从多项式$|\mbf{A}-\lambda\mbf{I}|$里面提个$(\lambda-\lambda_1)^r$出来，其中$r$就是$\lambda_1$的几何重数. 详细证明丘高代p272.
\end{proof}

\begin{proposition}\label{characteristic: subspace-prop1}
\rm 设$\lambda_1,\lambda_2,\cdots,\lambda_m$是$n$阶矩阵$\mbf{A}$的特征值，$\alpha_1,\alpha_2,\cdots,\alpha_m$分别是与之对应的特征向量. 如果$\lambda_1,\lambda_2,\cdots,\lambda_m$均互不相等，则$\alpha_1,\alpha_2,\cdots,\alpha_m$线性无关.
\end{proposition}

\begin{proof}
对$m$进行归纳证明. 当$m=1$时，$\alpha_1$线性无关. 假设在$m=k$时成立. 那么当$m=k+1$，我们考察等式
\begin{equation}
b_1\alpha_1+b_2\alpha_2+\cdots+b_k\alpha_{k}+b_{k+1}\alpha_{k+1} = \mbf{0},
\end{equation}
上式两边左乘$\mbf{A}$，有
$$
b_1\mbf{A}\alpha_1+b_2\mbf{A}\alpha_2+\cdots+b_k\mbf{A}\alpha_{k}+b_{k+1}\mbf{A}\alpha_{k+1} = \mbf{0}, 
$$
即
\begin{equation}
b_1\lambda_1\alpha_1+b_2\lambda_2\alpha_2+\cdots+b_k\lambda_k\alpha_{k}+b_{k+1}\lambda_{k+1}\alpha_{k+1} = \mbf{0}.
\end{equation}
将(3)式乘上$\lambda_{k+1}$减去(4)式，有
$$
b_1(\lambda_{k+1}-\lambda_1)\alpha_1+b_2(\lambda_{k+1}-\lambda_2)\alpha_2+\cdots+b_k(\lambda_{k+1}-\lambda_k)\alpha_{k} = \mbf{0}
$$
根据假设$n=k$时命题成立，那么
$$
b_1(\lambda_{k+1}-\lambda_1) = b_2(\lambda_{k+1}-\lambda_2) =\cdots = b_k(\lambda_{k+1}-\lambda_k).
$$
其中$(\lambda_{k+1} - \lambda_i)$均不为零$(1\leq i \leq k)$，因此$b_1 = b_2 = \cdots = b_k = 0$，带入(3)式，因$\alpha_{k+1} \neq \mbf{0}$，所以$b_{k+1}=0$. 即$n = k+1$时命题也成立.  
\end{proof}

\begin{corollary}\label{characteristic: subspace-prop2}
\rm 设$\lambda_1$和$\lambda_2$是$n$阶矩阵$\mbf{A}$的两个不同的特征值，那么分别对应于$\lambda_1$及$\lambda_2$下的两个线性无关特征向量组$\xi_1,\xi_2,\cdots,\xi_s$和$\eta_1,\eta_2,\cdots,\eta_t$合在一起也是线性无关的.
\end{corollary}

\begin{proof}
由proposition \ref{characteristic: subspace-prop1}，可以清晰的感觉到不同特征值的特征子空间是distinct的，那么当前这个命题就很显然了. 
\end{proof}

\newpage
\subsection{相似矩阵}

\begin{definition}
\rm 设$\mbf{A}$和$\mbf{B}$都是$n$阶矩阵，如果存在一个$n$阶可逆矩阵$\mbf{P}$使得
$$
\mbf{P}^{-1}\mbf{A}\mbf{P} = \mbf{B},
$$
那么称$\mbf{A}$和$\mbf{B}$是相似的，记做$\mbf{A} \sim \mbf{B}$.
\end{definition}

\begin{proposition}
\rm 相似矩阵有相等的特征多项式，从而特征值亦相同. 
\end{proposition}

\begin{proof}
设$\mbf{A} \sim \mbf{B}$，有
$$
|\mbf{B} - \lambda\mbf{I}| = |\mbf{P}^{-1}\mbf{A}\mbf{P} -\lambda\mbf{P}^{-1}\mbf{P}| = |\mbf{P}^{-1}(\mbf{A}-\lambda\mbf{I})\mbf{P}| =|\mbf{A}-\lambda\mbf{I}|.
$$
\end{proof}

\begin{definition}
\rm 若$n$阶矩阵$\mbf{A}$相似于一个对角矩阵，那么称$\mbf{A}$可对角化. 
\end{definition}

\begin{theorem}
\rm $n$阶矩阵$\mbf{A}$可对角化的充分条件是存在$n$个线性无关的列向量$\mbf{\alpha}_1,\mbf{\alpha}_2,\cdots,\mbf{\alpha}_n$，以及$n$个数$\lambda_1,\lambda_2,\cdots,\lambda_n$(它们之中有些可能相等)，使得
$$
\mbf{A}\mbf{\alpha}_i = \lambda\mbf{\alpha}_i,\, i = 1,2,\cdots,n.
$$
这时，令$P = (\mbf{\alpha}_1,\mbf{\alpha}_2,\cdots,\mbf{\alpha}_n)$，则
$$
P^{-1}\mbf{A}P = \text{diag}\{\lambda_1,\lambda_2,\cdots,\lambda_n\}.
$$
\end{theorem}

\begin{proof}
\rm \emph{充分性}\ 设存在$n$个线性无关的列向量$\mbf{\alpha}_1,\mbf{\alpha}_2,\cdots,\mbf{\alpha}_n$，以及$n$个数$\lambda_1,\lambda_2,\cdots,\lambda_n$，使得
$$
\mbf{A}\mbf{\alpha}_i = \lambda\mbf{\alpha}_i,\, i = 1,2,\cdots,n.
$$
于是有
$$
(\mbf{A}\mbf{\alpha}_1,\mbf{A}\mbf{\alpha}_2,\cdots,\mbf{A}\mbf{\alpha}_n) = (\lambda_1\mbf{\alpha}_1,\lambda_2\mbf{\alpha}_2,\cdots,\lambda_n\mbf{\alpha}_n),
$$
记$P=(\mbf{\alpha}_1,\mbf{\alpha}_2,\cdots,\mbf{\alpha}_n)，D = \text{diag}\{\lambda_1,\lambda_2,\cdots,\lambda_n\}$. 因此有
$$
\mbf{A}P = PD,
$$
由于$P$是满秩矩阵，所以$P$可逆，那么即有$P^{-1}\mbf{A}P = D$.

\emph{必要性}\ 若$\mbf{A} \sim D=\text{diag}\{\lambda_1,\lambda_2,\cdots,\lambda_n\}$，因此存在可逆矩阵$P=(\mbf{\alpha}_1,\mbf{\alpha}_2,\cdots,\mbf{\alpha}_n)$使得
$$
\begin{array}{rl}
P^{-1}\mbf{A}P &= D\\
\mbf{A}P &= P^{-1}D\\
(\mbf{A}\mbf{\alpha}_1,\mbf{A}\mbf{\alpha}_2,\cdots,\mbf{A}\mbf{\alpha}_n) &= (\lambda_1\mbf{\alpha}_1,\lambda_2\mbf{\alpha}_2,\cdots,\lambda_n\mbf{\alpha}_n).
\end{array}
$$
即有对应列向量有$\mbf{A}\mbf{\alpha}_i = \lambda\mbf{\alpha}_i,\, i = 1,2,\cdots,n.$
\end{proof}

\begin{corollary}
\rm 若$n$阶矩阵$\mbf{A}$与对角矩阵$D=\text{diag}\{\lambda_1,\lambda_2,\cdots,\lambda_n\}$相似，那么$\lambda_1,\lambda_2,\cdots,\lambda_n$是$\mbf{A}$的特征值.
\end{corollary}


\begin{corollary}
\rm 若$n$阶矩阵$\mbf{A}$的$n$个特征值互不相等，则$\mbf{A}$与对角矩阵相似.
\end{corollary}

\subsection{矩阵对角化的条件}

\begin{theorem}
\rm $n$阶矩阵$\mbf{A}$可对角化的充要条件是$\mbf{A}$有$n$个线性无关的特征向量$\mbf{\alpha}_1,\mbf{\alpha}_2,\cdots,\mbf{\alpha}_n$. 令$P=(\mbf{\alpha}_1,\mbf{\alpha}_2,\cdots,\mbf{\alpha}_n)$，则
$$
P^{-1}\mbf{A}P = \text{diag}(\lambda_1,\lambda_2,\cdots,\lambda_n),
$$
其中$\lambda_i$是$\mbf{\alpha}_i$对应的特征值$(i=1,2,\cdots,n)$. {\color{blue} 注意矩阵$P$的构造中的列向量的位置要和对角矩阵的对角线元素对应}.
\end{theorem}

\begin{annotation}
\rm {\color{red} 如何判定$n$阶矩阵$\mbf{A}$有没有$n$个线性无关的特征向量}?
\begin{enumerate}
	\item 求出$\mbf{A}$的全部特征值，设其为$\lambda_1,\lambda_2,\cdots,\lambda_m$.
	\item 对于每一个特征值$\lambda_i$，求出齐次线性方程组$(\mbf{A}-\lambda_i\mbf{\alpha})\mbf{X}=\mbf{0}$的一个基础解系$\eta_{ir_i},\eta_{i2},\cdots,\eta_{ir}$.
	\item 由corollary \ref{characteristic: subspace-prop2}，这$m$组线性无关向量合在一起还是线性无关的. 从而如果$r_1+r_2+\cdots+r_m = n$，那么$\mbf{A}$有$n$个线性无关的特征向量，即$\mbf{A}$可对角化. 反之如果$r_1+r_2+\cdots+r_m < n$，那么$\mbf{A}$没有$n$个线性无关的特征向量，即$\mbf{A}$不可对角化. 
\end{enumerate}
\end{annotation}

\begin{theorem}
\rm $n$阶矩阵$\mbf{A}$可对角化的充分必要条件是$\mbf{A}$的对应不同特征值的特征子空间的维数之和等于$n$.
\end{theorem}

\begin{proof}
\rm 从前面的annotation即可得到.
\end{proof}

\begin{corollary}
\rm 若$n$阶矩阵$\mbf{A}$有$n$个不同的特征值，那么$\mbf{A}$可对角化. 
\end{corollary}

\begin{theorem}
\rm 数域$F$上的$n$阶矩阵$\mbf{A}$可对角化的充要条件是$\mbf{A}$的特征多项式的全部复根都属于$F$，并且$\mbf{A}$的每个特征值的几何重数等于它的代数重根.
\end{theorem}

\newpage
\subsection{实对称矩阵的对角化}

\begin{definition}
\rm 如果对于$n$级实矩阵$\mbf{A},\mbf{B}$，存在一个$n$级正交矩阵$T$，使得$T^{-1}\mbf{A}T=\mbf{B}$，那么称$\mbf{A}$正交相似于$\mbf{B}$.
\end{definition}

\begin{theorem}\label{symmetry: real}
\rm $n$阶实对称矩阵的特征多项式的每一个复根都是实数，从而它们都是特征值.({\color{blue}代数基本定理告诉我们$n$次多项式在复数域上都$n$个复根，所以这里是相对于代数基本定理来说的})
\end{theorem}

\begin{proof}
\rm 设$\lambda$是$n$阶实对称矩阵的特征多项式的任意一个复根，要证$\lambda$是一个实数，则需要证明$\bar{\lambda} = \lambda$. 首先把$\mbf{A}$看做一个复矩阵，则$\lambda$是$\mbf{A}$的一个特征值，从而存在对应的非零特征向量$\mbf{\alpha}\in \mathbb{C}^n$，使得
\begin{equation}
\mbf{A}\mbf{\alpha} = \lambda\mbf{\alpha}.
\end{equation}
我们定义$\bar{\mbf{A}}$表示对$\mbf{A}$里面的所有元素取共轭复数，然后对(1)式两边同时取共轭复数
$$
\begin{array}{ll}
\overline{\mbf{A}\mbf{\alpha}} = \overline{\lambda\mbf{\alpha}} \\
\overline{\mbf{A}}\overline{\mbf{\alpha}} = \overline{\lambda}\overline{\mbf{\alpha}}
\end{array}.
$$
由于$\mbf{A}$是实对称矩阵，因此可以得到$\mbf{A}\overline{\mbf{\alpha}} = \overline{\lambda}\overline{\mbf{\alpha}}$. 对(1)式两边取转置，有
$$
\begin{array}{ll}
(\mbf{A}\mbf{\alpha})^T = (\lambda\mbf{\alpha})^T\\
\mbf{\alpha}^T\mbf{A}^T = \lambda\mbf{\alpha}^T,
\end{array}
$$
由于$\mbf{A}$是对称矩阵，因此可以得到$\mbf{\alpha}^T\mbf{A} = \lambda\mbf{\alpha}^T$. 对得到的一个等式两边左乘$\mbf{a}^T$减去第二个等式两边右侧$\overline{\mbf{\alpha}}$，可以得到
$$
(\overline{\lambda}-\lambda)\mbf{\alpha}^T\overline{\mbf{\alpha}} = 0.
$$
由于$\mbf{\alpha} \neq 0$，所以$\mbf{\alpha}^T\overline{\mbf{\alpha}} \neq 0$(互为共轭的复数的乘积非负)，从而$\overline{\lambda} = \lambda$.
\end{proof}

\begin{corollary}\label{symmetry: real2}
\rm 实对称矩阵一定有特征值.
\end{corollary}

\begin{proof}
\rm 配合代数基本定理和theorem \ref{symmetry: real}可知实对称矩阵一定有实数根，尽管可能是重根.
\end{proof}


\begin{theorem}\label{symmetry: theorem1}
\rm 实对称矩阵$\mbf{A}$的对应不同的特征值的特征向量是正交.
\end{theorem}

\begin{proof}
设$\lambda_1,\lambda_2$的$\mbf{A}$的两个不同特征值，$\mbf{A}$的分别与之它们对应的两个特征向量为$\mbf{\alpha}_1,\mbf{\alpha}_2$. 要证明$\inp{\mbf{\alpha}_1}{\mbf{\alpha}_2}=0$，为此计算
$$
\begin{array}{ll}
\lambda_1\inp{\mbf{\alpha}_1}{\mbf{\alpha}_2} = \inp{\lambda_1\mbf{\alpha}_1}{\mbf{\alpha}_2} = (\mbf{A}\mbf{\alpha}_1)^T\mbf{\alpha}_2 = \mbf{\alpha}_1^T\mbf{A}\mbf{\alpha}_2, \\
 \lambda_2\inp{\mbf{\alpha}_1}{\mbf{\alpha}_2} = \inp{\mbf{\alpha}_1}{\lambda_2\mbf{\alpha}_2}= \mbf{\alpha}_1^T(\mbf{A}\mbf{\alpha}_2) = \mbf{\alpha}_1^T\mbf{A}\mbf{\alpha}_2,
\end{array}
$$
上述两式相减，得到$(\lambda_1-\lambda_2)\inp{\mbf{\alpha}_1}{\mbf{\alpha}_2}=0$. 由于$\lambda_1 \neq \lambda_2$，因此$\inp{\mbf{\alpha}_1}{\mbf{\alpha}_2} = 0$.
\end{proof}

\begin{theorem}\label{symmetry: theorem2}
\rm 实对称矩阵一定正交相似于对角矩阵.
\end{theorem}

\begin{proof}
对实对称矩阵的阶数$n$进行归纳. 当$n=1$时，$(1)^{-1}(a)(1) = (a)$，因此命题成立. 假设对于$n-1$阶实对称矩阵命题成立($n=2,3,\cdots$)，我们来考察$n$阶实对称矩阵$\mbf{A}$. 由corollary \ref{symmetry: real2}可知$\mbf{A}$一定存在一个特征值$\lambda_1$，那么存在$\mbf{A}$的对应$\lambda_1$的一个非零特征向量$\mbf{\alpha}_1$. 我们将$\mbf{\alpha}_1$单位化得到$\eta_1$，我们将$\eta_1$扩充称$\mathbb{R}^n$的一个基，然后经过施密特正交化和单位化，得到$\mathbb{R}^n$的一个标准正交基$\eta_1,\eta_2,\cdots,\eta_n$. 由proposition \ref{orthogonal-matrix: basis}可知$T_1=(\eta_1,\eta_2,\cdots,\eta_n)$是一个$n$级正交矩阵. 于是有
\begin{equation}
T_1^{-1}\mbf{A}T_1 = T_1^{-1}(\mbf{A}\eta_1,\mbf{A}\eta_2,\cdots,\mbf{A}\eta_n) = (T_1^{-1}\lambda_1\eta_1,T_1^{-1}\mbf{A}\eta_2,\cdots,T_1^{-1}\mbf{A}\eta_n).
\end{equation}
由于$T_1^{-1}T_1=(T_1^{-1}\eta_1,T_1^{-1}\eta_2,\cdots,T_1^{-1}\eta_n)=(\varepsilon_1,\varepsilon_2,\cdots,\varepsilon)$，因此$T_1^{-1}\eta_1=\varepsilon_1$，带入(2)式. 从而得到
$$
T_1^{-1}\mbf{A}T_1 = \begin{pmatrix}
\lambda_1 & \mbf{\beta} \\
\mbf{0} & \mbf{B} 
\end{pmatrix}
$$ 
其中$\mbf{0}\in \mathbb{R}^{(n-1),1}$，$\mbf{\beta} \in \mathbb{R}^{1,(n-1)}$，自然地$\mbf{B}$是一个$n-1$阶矩阵. 首先我们考察一下$(T_1^{-1}\mbf{A}T_1)^T$，有
$$
(T_1^{-1}\mbf{A}T_1)^T = (\mbf{A}T_1)^T(T_1^{-1})^{T} = T_1^T \mbf{A}^T ({T_1^{-1}})^T = T_1^{-1}\mbf{A}T_1. 
$$
因此$T_1^{-1}\mbf{A}T_1$也是一个实对称矩阵，那么有$\mbf{\beta}=\mbf{0}$，$\mbf{B}$也是一个实对称矩阵. 自然地，我们希望把$(T_1^{-1}\mbf{A}T_1)^T$中$\mbf{B}$换成$T_2^{-1}\mbf{B}T_2 = \text{diag}\{\lambda_1,\lambda_2,\cdots,\lambda_n\}$，来用假设中$n-1$阶实对称矩阵的结论. 这里很容易联想到{\color{blue}分块矩阵的初等变换}，即
$$
\begin{pmatrix}
1 & \mbf{0} \\
\mbf{0} & T_2^{-1}
\end{pmatrix}
\begin{pmatrix}
\lambda_1 & \mbf{0} \\
\mbf{0} & \mbf{B} 
\end{pmatrix}
\begin{pmatrix}
1 & \mbf{0} \\
\mbf{0} & T_2
\end{pmatrix}
= \begin{pmatrix}
1 & \mbf{0} \\
\mbf{0} & T_2
\end{pmatrix}^{-1}T_1^{-1}\mbf{A}T_1\begin{pmatrix}
1 & \mbf{0} \\
\mbf{0} & T_2
\end{pmatrix},
$$
所以我们需要重新构造一个新的正交矩阵$T$，令
$$
T = T_1\begin{pmatrix}
1 & \mbf{0} \\
\mbf{0} & T_2
\end{pmatrix}. 
$$
显然$T$是一个正交矩阵，即对$n$阶实对称矩阵，命题也成立. 
\end{proof}

\begin{annotation}
\rm {\color{red}对于$n$阶实对称矩阵$\mbf{A}$，如何找到一个正交矩阵$T$使得$T^{-1}\mbf{A}T$为一个对角矩阵}？ 步骤如下
\begin{enumerate}
	\item 计算特征多项式$|\mbf{A}-\lambda\mbf{I}|$，求出它的全部不同的根$\lambda_1,\lambda_2,\cdots,\lambda_m$，它们是$\mbf{A}$全部的特征值.
	\item 对于每一个特征值$\lambda_i$($i=1,2,\cdots,m$)，求$(\mbf{A}-\lambda_i\mbf{I})X=0$一个基础解系，并对这个基础解系进行施密特正交化和单位化，得到$\eta_{i1},\eta_{i2},\cdots,\eta_{ir_i}$. 它们都是$\mbf{A}$的对应于$\lambda_i$的特征向量. 
	\item 由theorem \ref{symmetry: theorem2}，可知$r_1 +r_2 +\cdots + r_m = n$，所以可对角化. 令
	$$
	T = (\eta_{11},\cdots,\eta_{1r_1},\cdots,\eta_{m1},\cdots,\eta_{mr_m}),
	$$
	由theorem \ref{symmetry: theorem1}可知$T$是$n$阶正交矩阵，且
	$$
	T^{-1}\mbf{A}T = \text{diag}\{\underbrace{\lambda_1,\cdots,\lambda_1}_{r_1},\cdots,\underbrace{\lambda_m,\cdots,\lambda_m}_{r_m}\}.
	$$
\end{enumerate}
\end{annotation}

\begin{theorem}
\rm 如果$n$阶实矩阵$\mbf{A}$正交相似于一个对角矩阵，那么$\mbf{A}$一定是对称矩阵.
\end{theorem}


\begin{theorem}
\rm 两个$n$阶实对称矩阵正交相似的充分必要条件是它们相似.
\end{theorem}


\newpage
\section{二次型}

\subsection{二次型及其标准型}

\begin{definition}
\rm 数域$F$上的一个$n$元二次型是系数在$F$中$n$个变量的二次齐次多项式，它的一般形式是
\begin{equation}
\begin{array}{rlll}
f(x_1,x_2,\cdots,x_n) = a_{11}x_1^2 + 2a_{12}x_1x_2 &+ 2a_{13}x_1x_3 &+ \cdots &+ 2a_{1n}x_1x_n \\
+a_{22}x_2^{2} &+ 2a_{23}x_2x_3 &+  \cdots &+2a_{2n}x_2x_n\\
+\cdots &\cdots &\cdots &\cdots  \\
&&&+a_{nn}x_n^2
\end{array}.
\end{equation}
(1)式也可以写成
\begin{equation}
f(x_1,x_2,\cdots,x_n) = \sum\limits_{i=1}^n\sum\limits_{j=1}^n a_{ij}x_ix_j,
\end{equation}
其中当$j>i$时，$a_{ji}=a_{ij}$.
\end{definition}

\begin{definition}
\rm 利用矩阵(2)式可表示为
$$
\begin{array}{rl}
f(x) =& x_1(a_{11}x_1 + a_{12}x_2 + \cdots + a_{1n}x_n) + x_2(a_{21}x_1 + a_{22}x_2 + \cdots + a_{2n}x_n) \\ 
&+ \cdots + x_n(a_{n1}x_1 + a_{n2}x_2 + \cdots + a_{nn}x_n) \\ \\
=&(x_1,x_2,\cdots,x_n)
\begin{pmatrix}
a_{11}x_1 + a_{12}x_2 + \cdots + a_{1n}x_n \\
a_{21}x_1 + a_{22}x_2 + \cdots + a_{2n}x_n \\
\vdots \\
a_{n1}x_1 + a_{n2}x_2 + \cdots + a_{nn}x_n
\end{pmatrix} \\ \\
=& (x_1,x_2,\cdots,x_n) 
\begin{pmatrix}
a_{11} & a_{12} & \cdots & a_{1n} \\
a_{21} & a_{22} & \cdots & a_{2n} \\
\vdots & \vdots & 		 & \vdots \\
a_{n1} & a_{n2} & \cdots & a_{nn}x_n
\end{pmatrix}
\begin{pmatrix}
x_1 \\
x_2 \\
\vdots \\
x_n
\end{pmatrix}
\end{array},
$$
记$\mbf{X} = \begin{pmatrix}
x_1 \\
x_2 \\
\vdots \\
x_n
\end{pmatrix}, \mbf{A} = \begin{pmatrix}
a_{11} & a_{12} & \cdots & a_{1n} \\
a_{21} & a_{22} & \cdots & a_{2n} \\
\vdots & \vdots & 		 & \vdots \\
a_{n1} & a_{n2} & \cdots & a_{nn}x_n
\end{pmatrix},$
则二次型可用矩阵记做
$$
f(x_1,x_2,\cdots,x_n)=\mbf{X}^T\mbf{A}\mbf{X}.
$$
此时，称$\mbf{A}$是二次型$f(x_1,x_2,\cdots,x_n)$的矩阵，它是对称矩阵. 显然$\mbf{A}$是唯一的: 它的主对角线元素依次是$x_1^2,x_2^2,\cdots,x_n^2$的系数; 它的$(i,j)$元素是$x_ix_j$的系数的一半，其中$i<j$. 
\end{definition}

\begin{definition}
\rm 令$\mbf{Y}=\begin{pmatrix}
y_1 \\
y_2 \\
\vdots \\
y_n \\
\end{pmatrix}$，设$C$是数域$F$上的$n$级可逆矩阵，则关系式
$$
\mbf{X} = C\mbf{Y}
$$
称为变量$x_1,x_2,\cdots,x_n$到变量$y_1,y_2,\cdots,y_n$的一个{\color{red}非退化线性替换}. 
\end{definition}

\begin{annotation}
\rm 将$n$元二次型$\mbf{X^T}\mbf{A}\mbf{X}$经过非退化线性替换$\mbf{X} = C\mbf{Y}$变成
\begin{equation}
(C\mbf{Y})^T\mbf{A}(C\mbf{Y}) = \mbf{Y}^TC^T\mbf{A}C\mbf{Y},
\end{equation}
记$\mbf{B}=C^T\mbf{A}C$，那么(3)式就可以写作$\mbf{Y}^T\mbf{B}\mbf{Y}$. 这就是变量$y_1,y_2,\cdots,y_n$的一个二次型. 因为$\mbf{A}$是对称矩阵，所以$\mbf{B}$也是对称矩阵，从而$\mbf{B}$正好是二次型$\mbf{Y}^T\mbf{B}\mbf{Y}$的矩阵.
\end{annotation}

\begin{definition}
\rm 给定两个$n$元二次型$\mbf{X}^T\mbf{A}\mbf{X}$和$\mbf{Y}^T\mbf{B}\mbf{Y}$，若存在一个非退化线性替换$\mbf{X} = C\mbf{Y}$可以把$\mbf{X}^T\mbf{A}\mbf{X}$变换成$\mbf{Y}^T\mbf{B}\mbf{Y}$，那么就称二次型$\mbf{X}^T\mbf{A}\mbf{X}$和$\mbf{Y}^T\mbf{B}\mbf{Y}$等价，记为$\mbf{X}^T\mbf{A}\mbf{X} \cong \mbf{Y}^T\mbf{B}\mbf{Y}$. 
\end{definition}

\begin{definition}
\rm 给定两个$n$阶矩阵$\mbf{A}$与$\mbf{B}$，若存在一个可逆$n$阶矩阵$C$使得
$$
C^T\mbf{A}C = \mbf{B},
$$
那么就称$\mbf{A}$与$\mbf{B}$ {\color{red}合同}，记为$\mbf{A} \simeq \mbf{B}$.
\end{definition}

\begin{proposition}
\rm 若两个$n$阶矩阵$\mbf{A}$与$\mbf{B}$合同，则满足下述简单性质
\begin{enumerate}
	\item 若$\mbf{A}$是对称矩阵，那么$\mbf{B}$也是对称矩阵. 
	\item $|\mbf{A}| = |\mbf{B}|$. 
\end{enumerate}
\end{proposition}


\begin{proposition}
\rm 两个$n$元二次型$\mbf{X}^T\mbf{A}\mbf{X}$和$\mbf{Y}^T\mbf{B}\mbf{Y}$等价当且仅当$\mbf{A}$和$\mbf{B}$合同(congruent).
\end{proposition}

\begin{definition}
\rm 如果二次型$\mbf{X}^T\mbf{A}\mbf{X}$等价于一个只含平方项的二次型(其对应的矩阵就是一个对角矩阵)，那么这个只含平方项的二次型称为$\mbf{X}^T\mbf{A}\mbf{X}$的一个{\color{red}标准型}.
\end{definition}

\begin{proposition}
\rm 任给$n$元二次型$\mbf{X}^T\mbf{A}\mbf{X}$都有一个标准型为
$$
\lambda_1y_1^2 + \lambda_2y^2 + \cdots + \lambda_n y^2,
$$
其中$\lambda_1,\lambda_2,\cdots,\lambda_n$是$\mbf{A}$的全部特征值. 
\end{proposition}

\begin{proof}
由theorem \ref{symmetry: theorem2}. 
\end{proof}

\begin{annotation}
\rm {\color{red}配方法}
\end{annotation}

\begin{proposition}
\rm 
$$
\begin{array}{ll}
P(j,i(k))^T = P(i,j(k)) \\
P(i,j)^T = P(i,j) \\
P(i(b))^T = P(i(b)) 
\end{array}
$$
\end{proposition}

\begin{definition}
\rm 设$\mbf{A},\mbf{B}$是一个$n$阶矩阵，$P$是任意的一个初等矩阵，若
$$
\mbf{B} = P^T\mbf{A}P,
$$
那么称$\mbf{B}$是$\mbf{A}$通过一个{\color{red}成对初等行列变换}得到的.
\end{definition}

\begin{lemma}
\rm 设$\mbf{A},\mbf{B}$都是$n$阶矩阵，若$\mbf{A}$合同于$\mbf{B}$当且仅当$\mbf{A}$是经过一系列成对初等行列变换可以得到$\mbf{B}$. 此时对$\mbf{I}$只做其中的列变换即可得到可逆矩阵$C$，使得$C^T\mbf{A}C = \mbf{B}$. 
\end{lemma}

\begin{theorem}
\rm 任一$n$级对称矩阵一定合同于对角矩阵. 
\end{theorem}

\end{document}
